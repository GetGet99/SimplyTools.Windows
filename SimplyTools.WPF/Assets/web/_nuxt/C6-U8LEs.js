import{u as L,a as R,b as A,d as B,c as S,_ as I}from"./DGNIRpLh.js";import{L as U,_ as q,a as N}from"./BPQDBCK9.js";import{u as P,a as Z,g as $,e as F,p as V}from"./xenwG-nP.js";import{e as O,f as j,r as f,a7 as Y,j as h,k as b,c as z,b as l,a as o,i as g,h as r,w as y,F as D,o as G,d as H}from"./CfbvuZjT.js";import{u as J}from"./CUNkdK4U.js";import"./CQCgYrss.js";import"./DmueuAKG.js";const K='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 9a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm0 1.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5Zm0-5a10 10 0 0 1 9.7 7.56.75.75 0 1 1-1.45.37 8.5 8.5 0 0 0-16.5 0 .75.75 0 0 1-1.45-.36A10 10 0 0 1 12 5.5Z"/></svg>',Q={class:"grid grid-cols-2 grid-rows-2 gap-4 h-screen overflow-hidden p-2"},W={class:"flex flex-col gap-2 row-span-2"},X={class:"flex flex-col gap-2"},ee={class:"flex items-center gap-1"},te={class:"flex flex-col gap-2"},ie=O({__name:"edit",async setup(ae){let s,d;L(R.pages.find(t=>t.path==="snippets"));let x;x="inmemory://index.liquid";const E=j("outputME");let a;const n=f(""),p=f(""),v=f("plaintext"),c=P().searchParams.get("id");{if(c===null)throw Y({status:404,statusText:"Snippet not found"});a=Z(c),n.value=([s,d]=h(()=>$(c)),s=await s,d(),s)}const i=new U;i&&i.registerTag("meta",{parse:function(t,e){this.templates=[];const m=i.parser.parseStream(e);m.on("tag:endmeta",()=>{m.stop()}).on("template",_=>{this.templates.push(_)}),m.start()},render:function*(t,e){return""}});async function T(){if(i)try{const t=n.value?V(n.value):{},e=a.value.replace(/{%\s*comment\s*%}[\s\S]*?{%\s*endcomment\s*%}/g,"");p.value=await i.parseAndRender(e,t)}catch(t){p.value=`⚠️ Error: ${t.message}`}}return b([a,n],T,{immediate:!0}),[s,d]=h(()=>J()),s=await s,d(),b(a,async()=>{try{const t=F(a.value),e=V(t??"");v.value=e.lang}catch{}},{immediate:!0}),(t,e)=>{const m=B,_=q,M=I,k=S,C=A,w=N;return G(),z(D,null,[l(m),o("div",Q,[o("div",W,[e[3]||(e[3]=o("label",{class:"font-bold p-button px-0"},"Template (autosaved)",-1)),l(_,{class:"grow",modelValue:r(a),"onUpdate:modelValue":e[0]||(e[0]=u=>g(a)?a.value=u:a=u)},null,8,["modelValue"])]),o("div",X,[o("div",ee,[e[5]||(e[5]=o("label",{class:"font-bold"},"Test Input (won't be saved)",-1)),e[6]||(e[6]=o("div",{class:"grow"},null,-1)),l(C,null,{default:y(()=>[l(k,{class:"manual flex gap-1 pl-2",href:`/snippets/?view=${r(c)}`},{default:y(()=>[l(M,{alt:"",icon:r(K)},null,8,["icon"]),e[4]||(e[4]=H(" View in Main App ",-1))]),_:1,__:[4]},8,["href"])]),_:1})]),l(w,{lang:"yaml",modelValue:r(n),"onUpdate:modelValue":e[1]||(e[1]=u=>g(n)?n.value=u:null),class:"grow"},null,8,["modelValue"])]),o("div",te,[e[7]||(e[7]=o("label",{class:"font-bold p-button px-0"},"Preview Output using Test Input",-1)),l(w,{ref_key:"outputME",ref:E,lang:r(v),readonly:"",modelValue:r(p),"onUpdate:modelValue":e[2]||(e[2]=u=>g(p)?p.value=u:null),"model-uri":r(x),class:"grow"},null,8,["lang","modelValue","model-uri"])])])],64)}}});export{ie as default};
