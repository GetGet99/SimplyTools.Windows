import{_ as ws,c as bs}from"./DmueuAKG.js";import{r as Ze,z as Rt,s as ks,j as Ne,k as X,l as Ts,c as xs,o as Ve,m as vs,n as _s,p as Ye,e as Et,I as zt,H as Nt,f as Vt,q as Je,v as Qe,g as Ct,w as Ss,b as Os,h as Le,a6 as Mt}from"./CfbvuZjT.js";import{u as fe,a as At}from"./CUNkdK4U.js";import{Z as ie,l as re,m as Pt,n as qt,o as Dt,e as Ls,p as Fs,y as Rs}from"./xenwG-nP.js";const Es={__name:"MonacoEditor",props:{lang:{type:String,required:!1,default:()=>"plaintext"},options:{type:null,required:!1,default:()=>({})},modelUri:{type:null,required:!1},modelValue:{type:String,required:!1,default:()=>""}},emits:["update:modelValue","load"],async setup(t,{expose:e,emit:s}){let n,i;const r=t,o=s,a=Ze(!0),c=Rt(()=>r.lang||r.options.language),u=ks(),l=Ze(),h={automaticLayout:!0};e({$editor:u});const p=([n,i]=Ne(()=>fe()),n=await n,i(),n);let f,T;return X(()=>r.modelValue,()=>{f?.getValue()!==r.modelValue&&f?.setValue(r.modelValue)}),X(()=>[r.lang,r.modelUri],()=>{T&&T.dispose(),T=p.editor.createModel(r.modelValue,c.value,r.modelUri),f?.setModel(T)}),X(()=>r.options,()=>{f?.updateOptions(Ye(r.options,h))}),X(l,(w,v)=>{!l.value||v||(f=p.editor.create(l.value,Ye(r.options,h)),T=p.editor.createModel(r.modelValue,c.value,r.modelUri),u.value=f,f.layout(),f.setModel(T),f.onDidChangeModelContent(()=>{o("update:modelValue",f.getValue())}),a.value=!1,o("load",f))}),Ts(()=>{f?.dispose(),T?.dispose()}),(w,v)=>(Ve(),xs("div",{ref_key:"editorElement",ref:l},[a.value?vs(w.$slots,"default",{key:0}):_s("",!0)],512))}},zs=bs(Es),Ns=Et({__name:"CodeEditor",props:zt({readonly:{type:Boolean},lang:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],async setup(t,{expose:e}){let s,n;[s,n]=Ne(()=>At()),await s,n();const i=Nt(t,"modelValue"),r=t,o=Vt("editorRef"),a=Rt(()=>o.value?.$editor);e({editor:a});function c(){a.value?.layout({},!0)}async function u(h){l="simplytools-"+h,(await fe()).editor.setTheme("simplytools-"+h)}let l="simplytools-dark";if(window?.matchMedia){let h=function(f){u(f.matches?"dark":"light")};const p=window.matchMedia("(prefers-color-scheme: dark)");u(p.matches?"dark":"light"),Je(()=>{p.addEventListener("change",h)}),Qe(()=>{p.removeEventListener("change",h)})}return X(()=>r.lang,async()=>{(await fe()).editor.setModelLanguage(a.value?.getModel(),r.lang)}),Je(()=>{window.addEventListener("resize",c)}),Qe(()=>{window.removeEventListener("resize",c)}),(h,p)=>{const f=zs,T=ws;return Ve(),Ct(T,null,{default:Ss(()=>[Os(f,{ref_key:"editorRef",ref:o,lang:h.lang,options:{theme:Le(l),minimap:{enabled:!1},readOnly:"readonly"in h?h.readonly:Le(Mt),scrollBeyondLastLine:!1},modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=w=>i.value=w),class:"base-bg-control-primary"},null,8,["lang","options","modelValue"])]),_:1})}}}),Vs=Object.assign(Ns,{__name:"CodeEditor"});let Ge=!1;async function Xe(){if(Ge)return;Ge=!0;const t=await fe();t.languages.register({id:"liquid"}),t.languages.registerHoverProvider("liquid",{provideHover:(e,s)=>{const n=jt(e,s);if(n){const i=n.split(/\.|\[|\]/).filter(o=>o!==""),r=i[0];if(Object.prototype.hasOwnProperty.call(e.schemas,r)){const o=e.schemas[r],a=i.slice(1),c=Cs(o,a);if(c)return{range:e.getWordAtPosition(s)?new t.Range(s.lineNumber,e.getWordAtPosition(s).startColumn,s.lineNumber,e.getWordAtPosition(s).endColumn):void 0,contents:[{value:"**Type**"},{value:`\`${c}\``}]}}}return null}}),t.languages.setMonarchTokensProvider("liquid",{defaultToken:"",tokenPostfix:".liquid",brackets:[{open:"{%-",close:"%}",token:"delimiter.tag.trim.left"},{open:"{%",close:"-%}",token:"delimiter.tag.trim.right"},{open:"{%-",close:"-%}",token:"delimiter.tag.trim.both"},{open:"{%",close:"%}",token:"delimiter.tag"},{open:"{{-",close:"}}",token:"delimiter.output.trim.left"},{open:"{{",close:"-}}",token:"delimiter.output.trim.right"},{open:"{{-",close:"-}}",token:"delimiter.output.trim.both"},{open:"{{",close:"}}",token:"delimiter.output"},{open:"{",close:"}",token:"delimiter.bracket"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"[",close:"]",token:"delimiter.array"}],tokenizer:{root:[[/{%-?\s*comment\s*-?%}/,{token:"comment.block.start",next:"@commentBlock"}],[/{%-?\s*raw\s*-?%}/,{token:"string.raw.start",next:"@rawBlock"}],[/{%-?\s*meta\s*-?%}/,{token:"meta.block.start",nextEmbedded:"yaml",next:"@metaBlock"}],[/\{\{-?/,{token:"delimiter.output",next:"@output"}],[/{%-?\s*(if|unless|elsif|else|case|when|for|tablerow|end\w+)\b/,{token:"keyword.control",next:"@tag"}],[/{%-?\s*(assign|capture|increment|decrement|include|render|cycle|break|continue)\b/,{token:"keyword",next:"@tag"}],[/{%-?/,{token:"delimiter.tag",next:"@tag"}],[/[^{]+/,""],[/[{]/,""]],metaBlock:[[/{%-?\s*endmeta\s*-?%}/,{token:"meta.block.end",next:"@pop",nextEmbedded:"@pop"}]],output:[[/-?\}\}/,{token:"delimiter.output",next:"@pop"}],{include:"@liquidExpression"}],tag:[[/-?\%}/,{token:"delimiter.tag",next:"@pop"}],{include:"@liquidExpression"}],commentBlock:[[/{%-?\s*endcomment\s*-?%}/,{token:"comment.block.end",next:"@pop"}],[/./,"comment.content"]],rawBlock:[[/{%-?\s*endraw\s*-?%}/,{token:"string.raw.end",next:"@pop"}],[/./,"string.raw"]],liquidExpression:[[/\s+/,"white"],[/\b\d+(\.\d+)?\b/,"number"],[/"(\\.|[^"\\])*"/,"string"],[/'(\\.|[^'\\])*'/,"string"],[/\b(true|false|nil)\b/,"constant.language"],[/\|/,{token:"operator",next:"@filter"}],[/[a-zA-Z_][\w\-]*/,"variable"],[/[\[\]().,]/,"delimiter"],[/==|!=|<=|>=|<|>|and|or|contains/,"operator"],[/\b(assign|capture|endcapture|increment|decrement|if|endif|unless|endunless|case|endcase|when|else|elsif|for|endfor|include|with|break|continue|cycle|in|limit|offset|render|tablerow|endtablerow|comment|endcomment|raw|endraw|paginate|endpaginate|form|endform)\b/,"keyword"],[/./,""]],filter:[[/\s*(\w+)/,"function"],[/:/,"operator","@filterargs"],[/\|/,"operator","@pop"],[/\%}|\}\}/,{token:"@rematch",next:"@pop"}]],filterargs:[[/\s+/,"white"],[/"(\\.|[^"\\])*"/,"string"],[/'(\\.|[^'\\])*'/,"string"],[/\b\d+(\.\d+)?\b/,"number"],[/[a-zA-Z_][\w\-]*/,"variable"],[/[,]/,"delimiter"],[/\|/,"operator","@popall"],[/\%}|\}\}/,{token:"@rematch",next:"@popall"}]]}}),t.languages.setLanguageConfiguration("liquid",{comments:{blockComment:["{%- comment -%}","{%- endcomment -%}"]},brackets:[["{%","-%}"],["{%-","%}"],["{%-","-%}"],["{%","%}"],["{{","-}}"],["{{-","}}"],["{{-","-}}"],["{{","}}"],["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"{%",close:"%}"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"[",close:"]"},{open:"(",close:")"}],surroundingPairs:[{open:"{%-",close:"%}"},{open:"{%",close:"-%}"},{open:"{%-",close:"-%}"},{open:"{%",close:"%}"},{open:"{{-",close:"}}"},{open:"{{",close:"-}}"},{open:"{{-",close:"-}}"},{open:"{{",close:"}}"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"[",close:"]"},{open:"(",close:")"}],folding:{markers:{start:/^\s*{%-?\s*(comment|raw|if|unless|case|for|tablerow|form|paginate|capture|schema|stylesheet|javascript|layout|block|section|style|liquid|meta)\b.*-?%}/,end:/^\s*{%-?\s*end(comment|raw|if|unless|case|for|tablerow|form|paginate|capture|schema|stylesheet|javascript|layout|block|section|style|liquid|meta)\b.*-?%}/}}}),t.languages.registerCompletionItemProvider("liquid",{triggerCharacters:[".","|","["," "],provideCompletionItems:(e,s)=>As(e,s)?{suggestions:[...Ps(t,s),...qs(t,e,s,e.schemas)]}:{suggestions:[]}})}function Cs(t,e){let s=t;for(const n of e)if(s instanceof ie&&(s=s.element),!/^\d+$/.test(n))if(s instanceof re){const i=s.shape;if(Object.prototype.hasOwnProperty.call(i,n))s=i[n];else return null}else return null;return s instanceof ie?"Array":s instanceof re?"Object":s instanceof Pt?"String":s instanceof qt?"Number":s instanceof Dt?"Boolean":"Unknown"}const Ms=(t,e,s)=>{e.schemas=s,Ke(t,e),e.onDidChangeContent(()=>{Ke(t,e)})};function As(t,e){const s=t.getLineContent(e.lineNumber),n=s.substring(0,e.column-1),i=Math.max(n.lastIndexOf("{{"),n.lastIndexOf("{%"));if(i===-1)return!1;const r=[s.indexOf("}}",i),s.indexOf("%}",i)].filter(a=>a!==-1),o=r.length>0?Math.min(...r):-1;return o!==-1?e.column-1>i&&e.column-1<=o:e.column-1>i}function Ps(t,e){const s=["assign","capture","endcapture","increment","decrement","if","endif","unless","endunless","case","endcase","when","else","elsif","for","endfor","include","with","break","continue","cycle","in","limit","offset","render","tablerow","endtablerow","comment","endcomment","raw","endraw","paginate","endpaginate","form","endform"],n=new t.Range(e.lineNumber,e.column,e.lineNumber,e.column);return s.map(i=>({label:i,kind:t.languages.CompletionItemKind.Keyword,insertText:i,range:n,sortText:`2${i}`}))}function jt(t,e){const n=t.getLineContent(e.lineNumber).substring(0,e.column-1),i=n.lastIndexOf("{{");if(i===-1)return null;const r=n.substring(i+2),a=/[a-zA-Z_][\w\.\[\]]*$/.exec(r.trim());return a?a[0]:null}function qs(t,e,s,n){const i=e.getWordUntilPosition(s),r=new t.Range(s.lineNumber,i.startColumn,s.lineNumber,i.endColumn),o=jt(e,s);if(o){const a=o.split(/\.|\[|\]/).filter(u=>u!==""),c=a[0];if(Object.prototype.hasOwnProperty.call(n,c)){const u=n[c],l=a.slice(1);return Ds(t,u,l,r)}}else return Object.keys(n).map(a=>({label:a,kind:t.languages.CompletionItemKind.Variable,insertText:a,sortText:`0${a}`,range:r}));return[]}function Ds(t,e,s,n){let i=e;for(const r of s)if(i instanceof ie&&(i=i.element),!/^\d+$/.test(r))if(i instanceof re){const o=i.shape;if(Object.prototype.hasOwnProperty.call(o,r))i=o[r];else return[]}else return[];if(i instanceof ie&&(i=i.element),i instanceof re){const r=[],o=i.shape;for(const a in o)if(Object.prototype.hasOwnProperty.call(o,a)){const c=o[a];let u=t.languages.CompletionItemKind.Field,l="",h="";c instanceof ie?(u=t.languages.CompletionItemKind.Variable,l="Array",h="Type: Array"):c instanceof re?(u=t.languages.CompletionItemKind.Class,l="Object",h="Type: Object"):c instanceof Pt?(u=t.languages.CompletionItemKind.Property,l="String",h="Type: String"):c instanceof qt?(u=t.languages.CompletionItemKind.Property,l="Number",h="Type: Number"):c instanceof Dt?(u=t.languages.CompletionItemKind.Property,l="Boolean",h="Type: Boolean"):(u=t.languages.CompletionItemKind.Property,l="Unknown",h="Type: Unknown"),r.push({label:a,kind:u,insertText:a,detail:l,documentation:h,range:n,sortText:`1${a}`})}return r}return[]}function Ke(t,e){const n=e.getValue().split(/\r?\n/),i=[],r=[],o=/\{%-?\s*(?!end)(\w+)(?:[\s\S]*?)-?%\}/g,a=/\{%-?\s*end(\w+)[\s\S]*?-?%\}/g,c=/\{\{-?/g,u=/-?\}\}/g;for(n.forEach((l,h)=>{const p=h+1;o.lastIndex=0,a.lastIndex=0,c.lastIndex=0,u.lastIndex=0;let f;const T=[];for(f=c.exec(l);f!==null;)T.push({type:"start",index:f.index}),f=c.exec(l);for(f=u.exec(l);f!==null;)T.push({type:"end",index:f.index}),f=u.exec(l);for(T.sort((w,v)=>w.index-v.index),T.forEach(w=>{if(w.type==="start")r.push({tag:"output",lineNumber:p,column:w.index+1});else{let v;for(;r.length>0&&(v=r.pop(),v?.tag!=="output"););(!v||v.tag!=="output")&&i.push({severity:t.MarkerSeverity.Error,message:"Unmatched closing '}}'",startLineNumber:p,startColumn:w.index+1,endLineNumber:p,endColumn:w.index+3})}}),f=o.exec(l);f!==null;){const w=f[1],v=f.index;!w.startsWith("end")&&$s(w)&&r.push({tag:w,lineNumber:p,column:v+1}),f=o.exec(l)}for(f=a.exec(l);f!==null;){const w=f[1],v=f.index;if(r.length===0)i.push({severity:t.MarkerSeverity.Error,message:`Unmatched end tag 'end${w}'`,startLineNumber:p,startColumn:v+1,endLineNumber:p,endColumn:v+f[0].length+1});else{const le=r.pop();le?.tag!==w&&i.push({severity:t.MarkerSeverity.Error,message:`Expected 'end${le?.tag}' but found 'end${w}'`,startLineNumber:p,startColumn:v+1,endLineNumber:p,endColumn:v+f[0].length+1})}f=a.exec(l)}});r.length>0;){const l=r.pop();let h="";l?.tag==="output"?h="Unclosed output tag '{{'":h=`Unclosed tag '${l?.tag}'`,i.push({severity:t.MarkerSeverity.Error,message:h,startLineNumber:l?.lineNumber||1,startColumn:l?.column||1,endLineNumber:l?.lineNumber||1,endColumn:l?.column||1})}}const js=["if","unless","case","for","tablerow","comment","raw","capture","form","paginate","layout","block","schema","stylesheet","javascript"];function $s(t){return js.includes(t)}const Is=Et({__name:"editor",props:zt({readonly:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],async setup(t){let e,s;const n=Nt(t,"modelValue"),i=Vt("editor"),r=At();return[e,s]=Ne(()=>Xe()),await e,s(),r&&(Xe(),X(n,async o=>{if(!o)return;let a=i?.value?.editor;if(a===void 0)return;const c=Ls(o);if(c)try{const u=Fs(c),l=Rs(u),h=a.getModel();h&&Ms(r,h,l)}catch{}},{immediate:!0})),(o,a)=>{const c=Vs;return Ve(),Ct(c,{ref:"editor",lang:"liquid",readonly:"readonly"in o?o.readonly:Le(Mt),modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=u=>n.value=u)},null,8,["readonly","modelValue"])}}}),Vo=Object.assign(Is,{__name:"SnippetsEditor"});class V{constructor(e,s,n,i,r){this.kind=e,this.input=s,this.begin=n,this.end=i,this.file=r}getText(){return this.input.slice(this.begin,this.end)}getPosition(){let[e,s]=[1,1];for(let n=0;n<this.begin;n++)this.input[n]===`
`?(e++,s=1):s++;return[e,s]}size(){return this.end-this.begin}}class J{liquidMethodMissing(e){}}const Bs=Object.prototype.toString,et=String.prototype.toLowerCase,Ce=Object.hasOwnProperty;function m(t){return typeof t=="string"}function S(t){return typeof t=="function"}function Us(t){return t&&S(t.then)}function pe(t){return t&&S(t.next)&&S(t.throw)&&S(t.return)}function Hs(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function d(t){return t=g(t),m(t)?t:N(t)?"":L(t)?t.map(e=>d(e)).join(""):String(t)}function ae(t){return t=g(t),L(t)?t:m(t)&&t.length>0?[t]:Zs(t)?Array.from(t):ke(t)?Object.keys(t).map(e=>[e,t[e]]):[]}function O(t){return t=g(t),N(t)?[]:L(t)?t:[t]}function g(t){return t instanceof J&&S(t.valueOf)?t.valueOf():t}function tt(t){return t=Number(t),isNaN(t)?0:t}function be(t){return typeof t=="number"}function $t(t){return t&&S(t.toLiquid)?$t(t.toLiquid()):t}function N(t){return t==null}function Ws(t){return t===void 0}function L(t){return Bs.call(t)==="[object Array]"}function It(t){return t&&be(t.length)}function Zs(t){return ke(t)&&Symbol.iterator in t}function st(t,e){t=t||{};for(const s in t)if(Ce.call(t,s)&&e(t[s],s,t)===!1)break;return t}function Bt(t){return t[t.length-1]}function ke(t){const e=typeof t;return t!==null&&(e==="object"||e==="function")}function Ut(t,e,s=1){const n=[];for(let i=t;i<e;i+=s)n.push(i);return n}function oe(t,e,s=" "){return Ht(t,e,s,(n,i)=>i+n)}function Ys(t,e,s=" "){return Ht(t,e,s,(n,i)=>n+i)}function Ht(t,e,s,n){t=String(t);let i=e-t.length;for(;i-- >0;)t=n(t,s);return t}function Wt(t){return t}function Js(t){return[...t].some(s=>s>="a"&&s<="z")?t.toUpperCase():t.toLowerCase()}function Qs(t,e){return t.length>e?t.slice(0,e-3)+"...":t}function nt(t,e){return t==null&&e==null?0:t==null?1:e==null||(t=et.call(t),e=et.call(e),t<e)?-1:t>e?1:0}function z(t){return function(...e){return t.call(this,...e.map(g))}}function Me(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function*ce(t){const e=new Set;for(const s of t){const n=JSON.stringify(s);e.has(n)||(e.add(n),yield s)}}const it="__liquidClass__";class Q extends Error{constructor(e,s){super(typeof e=="string"?e:e.message),this.context="",typeof e!="string"&&Object.defineProperty(this,"originalError",{value:e,enumerable:!1}),Object.defineProperty(this,"token",{value:s,enumerable:!1}),Object.defineProperty(this,it,{value:"LiquidError",enumerable:!1})}update(){Object.defineProperty(this,"context",{value:nn(this.token),enumerable:!1}),this.message=rn(this.message,this.token),this.stack=this.message+`
`+this.context+`
`+this.stack,this.originalError&&(this.stack+=`
From `+this.originalError.stack)}static is(e){return e?.[it]==="LiquidError"}}class Gs extends Q{constructor(e,s){super(e,s),this.name="TokenizationError",super.update()}}class Xs extends Q{constructor(e,s){super(e,s),this.name="ParseError",this.message=e.message,super.update()}}class Ks extends Q{constructor(e,s){super(e,s.token),this.name="RenderError",this.message=e.message,super.update()}static is(e){return e.name==="RenderError"}}class Zt extends Q{constructor(e){super(e[0],e[0].token),this.errors=e,this.name="LiquidErrors";const s=e.length>1?"s":"";this.message=`${e.length} error${s} found`,super.update()}static is(e){return e.name==="LiquidErrors"}}class en extends Q{constructor(e,s){super(e,s),this.name="UndefinedVariableError",this.message=e.message,super.update()}}class tn extends Error{constructor(e){super(`undefined variable: ${e}`),this.name="InternalUndefinedVariableError",this.variableName=e}}class sn extends Error{constructor(e){super(e),this.name="AssertionError",this.message=e+""}}function nn(t){const[e,s]=t.getPosition(),n=t.input.split(`
`),i=Math.max(e-2,1),r=Math.min(e+3,n.length);return Ut(i,r+1).map(a=>{const c=a===e?">> ":"   ",u=oe(String(a),String(r).length);let l=`${c}${u}| `;const h=a===e?`
`+oe("^",s+l.length):"";return l+=n[a-1],l+=h,l}).join(`
`)}function rn(t,e){e.file&&(t+=`, file:${e.file}`);const[s,n]=e.getPosition();return t+=`, line:${s}, col:${n}`,t}const y=[0,0,0,0,0,0,0,0,0,20,4,4,4,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,2,8,0,0,0,0,8,0,0,0,64,0,65,0,0,33,33,33,33,33,33,33,33,33,33,0,0,2,2,2,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],on=1,te=4,rt=8,Yt=16,an=32,ln=64,cn=128;function ue(t){const e=t.charCodeAt(0);return e>=128?!y[e]:!!(y[e]&on)}y[160]=y[5760]=y[6158]=y[8192]=y[8193]=y[8194]=y[8195]=y[8196]=y[8197]=y[8198]=y[8199]=y[8200]=y[8201]=y[8202]=y[8232]=y[8233]=y[8239]=y[8287]=y[12288]=te;y[8220]=y[8221]=cn;function F(t,e){if(!t){const s=typeof e=="function"?e():e||`expect ${t} to be true`;throw new sn(s)}}function me(t,e=`unexpected ${JSON.stringify(t)}`){F(!t,e)}class un extends J{equals(e){return N(g(e))}gt(){return!1}geq(){return!1}lt(){return!1}leq(){return!1}valueOf(){return null}}class se extends J{equals(e){return e instanceof se?!1:(e=g(e),m(e)||L(e)?e.length===0:ke(e)?Object.keys(e).length===0:!1)}gt(){return!1}geq(){return!1}lt(){return!1}leq(){return!1}valueOf(){return""}static is(e){return e instanceof se}}class Ae extends se{equals(e){return e===!1||N(g(e))?!0:m(e)?/^\s*$/.test(e):super.equals(e)}static is(e){return e instanceof Ae}}class Pe extends J{constructor(e,s,n){super(),this.i=0,this.length=e,this.name=`${n}-${s}`}next(){this.i++}index0(){return this.i}index(){return this.i+1}first(){return this.i===0}last(){return this.i===this.length-1}rindex(){return this.length-this.i}rindex0(){return this.length-this.i-1}valueOf(){return JSON.stringify(this)}}class Jt{constructor(){this.buffer=""}write(e){this.buffer+=d(e)}}class hn{constructor(){throw this.buffer="",this.stream=null,new Error("streaming not supported in browser")}}class dn{constructor(){this.buffer=""}write(e){e=g(e),typeof e!="string"&&this.buffer===""?this.buffer=e:this.buffer=d(this.buffer)+d(e)}}class ot extends J{constructor(e=()=>""){super(),this.superBlockRender=e}*super(){const e=new Jt;return yield this.superBlockRender(e),e.buffer}}function A(t){return t&&S(t.equals)&&S(t.gt)&&S(t.geq)&&S(t.lt)&&S(t.leq)}const at=new un,Qt={true:!0,false:!1,nil:at,null:at,empty:new se,blank:new Ae};function lt(t){const e={};for(const[s,n]of Object.entries(t)){let i=e;for(let r=0;r<s.length;r++){const o=s[r];i[o]=i[o]||{},r===s.length-1&&ue(s[r])&&(i[o].needBoundary=!0),i=i[o]}i.data=n,i.end=!0}return e}var ge=function(){return ge=Object.assign||function(e){for(var s,n=1,i=arguments.length;n<i;n++){s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},ge.apply(this,arguments)};function _(t,e,s,n){function i(r){return r instanceof s?r:new s(function(o){o(r)})}return new(s||(s=Promise))(function(r,o){function a(l){try{u(n.next(l))}catch(h){o(h)}}function c(l){try{u(n.throw(l))}catch(h){o(h)}}function u(l){l.done?r(l.value):i(l.value).then(a,c)}u((n=n.apply(t,[])).next())})}function q(t){return _(this,void 0,void 0,function*(){if(!pe(t))return t;let e,s=!1,n="next";do{const i=t[n](e);s=i.done,e=i.value,n="next";try{pe(e)&&(e=q(e)),Us(e)&&(e=yield e)}catch(r){n="throw",e=r}}while(!s);return e})}function D(t){if(!pe(t))return t;let e,s=!1,n="next";do{const i=t[n](e);if(s=i.done,e=i.value,n="next",pe(e))try{e=D(e)}catch(r){n="throw",e=r}}while(!s);return e}const fn=/%([-_0^#:]+)?(\d+)?([EO])?(.)/;function pn(t){return[31,mn(t)?29:28,31,30,31,30,31,31,30,31,30,31]}function Gt(t){let e=0;for(let s=0;s<t.getMonth();++s)e+=pn(t)[s];return e+t.getDate()}function ct(t,e){const s=Gt(t)+(e-t.getDay()),i=7-new Date(t.getFullYear(),0,1).getDay()+e;return String(Math.floor((s-i)/7)+1)}function mn(t){const e=t.getFullYear();return!!((e&3)===0&&(e%100||e%400===0&&e))}function gn(t){const e=t.getDate();if([11,12,13].includes(e))return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function yn(t){return parseInt(t.getFullYear().toString().substring(0,2),10)}const wn={d:2,e:2,H:2,I:2,j:3,k:2,l:2,L:3,m:2,M:2,S:2,U:2,W:2},bn=new Set("aAbBceklpP");function ut(t,e){const s=Math.abs(t.getTimezoneOffset()),n=Math.floor(s/60),i=s%60;return(t.getTimezoneOffset()>0?"-":"+")+oe(n,2,"0")+(e.flags[":"]?":":"")+oe(i,2,"0")}const Fe={a:t=>t.getShortWeekdayName(),A:t=>t.getLongWeekdayName(),b:t=>t.getShortMonthName(),B:t=>t.getLongMonthName(),c:t=>t.toLocaleString(),C:t=>yn(t),d:t=>t.getDate(),e:t=>t.getDate(),H:t=>t.getHours(),I:t=>String(t.getHours()%12||12),j:t=>Gt(t),k:t=>t.getHours(),l:t=>String(t.getHours()%12||12),L:t=>t.getMilliseconds(),m:t=>t.getMonth()+1,M:t=>t.getMinutes(),N:(t,e)=>{const s=Number(e.width)||9,n=String(t.getMilliseconds()).slice(0,s);return Ys(n,s,"0")},p:t=>t.getHours()<12?"AM":"PM",P:t=>t.getHours()<12?"am":"pm",q:t=>gn(t),s:t=>Math.round(t.getTime()/1e3),S:t=>t.getSeconds(),u:t=>t.getDay()||7,U:t=>ct(t,0),w:t=>t.getDay(),W:t=>ct(t,1),x:t=>t.toLocaleDateString(),X:t=>t.toLocaleTimeString(),y:t=>t.getFullYear().toString().slice(2,4),Y:t=>t.getFullYear(),z:ut,Z:(t,e)=>t.getTimeZoneName()||ut(t,e),t:()=>"	",n:()=>`
`,"%":()=>"%"};Fe.h=Fe.b;function he(t,e){let s="",n=e,i;for(;i=fn.exec(n);)s+=n.slice(0,i.index),n=n.slice(i.index+i[0].length),s+=kn(t,i);return s+n}function kn(t,e){const[s,n="",i,r,o]=e,a=Fe[o];if(!a)return s;const c={};for(const p of n)c[p]=!0;let u=String(a(t,{flags:c,width:i,modifier:r})),l=bn.has(o)?" ":"0",h=i||wn[o]||0;return c["^"]?u=u.toUpperCase():c["#"]&&(u=Js(u)),c._?l=" ":c[0]&&(l="0"),c["-"]&&(h=0),oe(u,h,l)}function Xt(){return typeof Intl<"u"?Intl.DateTimeFormat:void 0}const Tn=6e4,xn=/([zZ]|([+-])(\d{2}):?(\d{2}))$/,Kt=["January","February","March","April","May","June","July","August","September","October","November","December"],vn=Kt.map(t=>t.slice(0,3)),es=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_n=es.map(t=>t.slice(0,3));class C{constructor(e,s,n){this.locale=s,this.DateTimeFormat=Xt(),this.date=new Date(e),this.timezoneFixed=n!==void 0,n===void 0&&(n=this.date.getTimezoneOffset()),this.timezoneOffset=m(n)?C.getTimezoneOffset(n,this.date):n,this.timezoneName=m(n)?n:"";const i=(this.date.getTimezoneOffset()-this.timezoneOffset)*Tn,r=this.date.getTime()+i;this.displayDate=new Date(r)}getTime(){return this.displayDate.getTime()}getMilliseconds(){return this.displayDate.getMilliseconds()}getSeconds(){return this.displayDate.getSeconds()}getMinutes(){return this.displayDate.getMinutes()}getHours(){return this.displayDate.getHours()}getDay(){return this.displayDate.getDay()}getDate(){return this.displayDate.getDate()}getMonth(){return this.displayDate.getMonth()}getFullYear(){return this.displayDate.getFullYear()}toLocaleString(e,s){return s?.timeZone?this.date.toLocaleString(e,s):this.displayDate.toLocaleString(e,s)}toLocaleTimeString(e){return this.displayDate.toLocaleTimeString(e)}toLocaleDateString(e){return this.displayDate.toLocaleDateString(e)}getTimezoneOffset(){return this.timezoneOffset}getTimeZoneName(){if(this.timezoneFixed)return this.timezoneName;if(this.DateTimeFormat)return this.DateTimeFormat().resolvedOptions().timeZone}getLongMonthName(){var e;return(e=this.format({month:"long"}))!==null&&e!==void 0?e:Kt[this.getMonth()]}getShortMonthName(){var e;return(e=this.format({month:"short"}))!==null&&e!==void 0?e:vn[this.getMonth()]}getLongWeekdayName(){var e;return(e=this.format({weekday:"long"}))!==null&&e!==void 0?e:es[this.displayDate.getDay()]}getShortWeekdayName(){var e;return(e=this.format({weekday:"short"}))!==null&&e!==void 0?e:_n[this.displayDate.getDay()]}valid(){return!isNaN(this.getTime())}format(e){return this.DateTimeFormat&&this.DateTimeFormat(this.locale,e).format(this.displayDate)}static createDateFixedToTimezone(e,s){const n=e.match(xn);if(n&&n[1]==="Z")return new C(+new Date(e),s,0);if(n&&n[2]&&n[3]&&n[4]){const[,,i,r,o]=n,a=(i==="+"?-1:1)*(parseInt(r,10)*60+parseInt(o,10));return new C(+new Date(e),s,a)}return new C(e,s)}static getTimezoneOffset(e,s){const n=s.toLocaleString("en-US",{timeZone:e}),i=s.toLocaleString("en-US",{timeZone:"UTC"}),r=new Date(n);return(+new Date(i)-+r)/(60*1e3)}}class Re{constructor(e,s){this.base=0,this.message=`${e} limit exceeded`,this.limit=s}use(e){e=tt(e),F(this.base+e<=this.limit,this.message),this.base+=e}check(e){e=tt(e),F(e<=this.limit,this.message)}}class qe extends V{constructor(e,[s,n],i,r,o,a,c,u){super(e,i,r,o,u),this.trimLeft=!1,this.trimRight=!1;const l=i[s]==="-",h=i[n-1]==="-";let p=l?s+1:s,f=h?n-1:n;for(;p<f&&y[i.charCodeAt(p)]&te;)p++;for(;f>p&&y[i.charCodeAt(f-1)]&te;)f--;this.contentRange=[p,f],this.trimLeft=l||a,this.trimRight=h||c}get content(){return this.input.slice(this.contentRange[0],this.contentRange[1])}}class ht extends qe{constructor(e,s,n,i,r){const{trimTagLeft:o,trimTagRight:a,tagDelimiterLeft:c,tagDelimiterRight:u}=i,[l,h]=[s+c.length,n-u.length];super(b.Tag,[l,h],e,s,n,o,a,r),this.tokenizer=new P(e,i.operators,r,this.contentRange),this.name=this.tokenizer.readTagName(),this.tokenizer.assert(this.name,"illegal tag syntax, tag name expected"),this.tokenizer.skipBlank(),this.args=this.tokenizer.input.slice(this.tokenizer.p,this.contentRange[1])}}class Sn extends qe{constructor(e,s,n,i,r){const{trimOutputLeft:o,trimOutputRight:a,outputDelimiterLeft:c,outputDelimiterRight:u}=i,l=[s+c.length,n-u.length];super(b.Output,l,e,s,n,o,a,r)}}class dt extends V{constructor(e,s,n,i){super(b.HTML,e,s,n,i),this.input=e,this.begin=s,this.end=n,this.file=i,this.trimLeft=0,this.trimRight=0}getContent(){return this.input.slice(this.begin+this.trimLeft,this.end-this.trimRight)}}class On extends V{constructor(e,s,n,i){super(b.Number,e,s,n,i),this.input=e,this.begin=s,this.end=n,this.file=i,this.content=Number(this.getText())}}class ve extends V{constructor(e,s,n,i){super(b.Word,e,s,n,i),this.input=e,this.begin=s,this.end=n,this.file=i,this.content=this.getText()}}class Ln extends V{constructor(e,s,n,i){super(b.Literal,e,s,n,i),this.input=e,this.begin=s,this.end=n,this.file=i,this.literal=this.getText(),this.content=Qt[this.literal]}}const ft={"==":2,"!=":2,">":2,"<":2,">=":2,"<=":2,contains:2,not:1,and:0,or:0},Fn={"==":0,"!=":0,">":0,"<":0,">=":0,"<=":0,contains:0,not:1,and:0,or:0};class Rn extends V{constructor(e,s,n,i){super(b.Operator,e,s,n,i),this.input=e,this.begin=s,this.end=n,this.file=i,this.operator=this.getText()}getPrecedence(){const e=this.getText();return e in ft?ft[e]:1}}class pt extends V{constructor(e,s,n,i,r,o){super(b.PropertyAccess,n,i,r,o),this.variable=e,this.props=s}}class ts extends V{constructor(e,s,n,i,r,o){super(b.Filter,n,i,r,o),this.name=e,this.args=s}}class En extends V{constructor(e,s,n,i,r,o){super(b.Hash,e,s,n,o),this.input=e,this.begin=s,this.end=n,this.name=i,this.value=r,this.file=o}}const zn=/[\da-fA-F]/,mt=/[0-7]/,gt={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v"};function yt(t){const e=t.charCodeAt(0);return e>=97?e-87:e>=65?e-55:e-48}function Nn(t){let e="";for(let s=1;s<t.length-1;s++){if(t[s]!=="\\"){e+=t[s];continue}if(gt[t[s+1]]!==void 0)e+=gt[t[++s]];else if(t[s+1]==="u"){let n=0,i=s+2;for(;i<=s+5&&zn.test(t[i]);)n=n*16+yt(t[i++]);s=i-1,e+=String.fromCharCode(n)}else if(!mt.test(t[s+1]))e+=t[++s];else{let n=s+1,i=0;for(;n<=s+3&&mt.test(t[n]);)i=i*8+yt(t[n++]);s=n-1,e+=String.fromCharCode(i)}}return e}class Vn extends V{constructor(e,s,n,i){super(b.Quoted,e,s,n,i),this.input=e,this.begin=s,this.end=n,this.file=i,this.content=Nn(this.getText())}}class Cn extends V{constructor(e,s,n,i,r,o){super(b.Range,e,s,n,o),this.input=e,this.begin=s,this.end=n,this.lhs=i,this.rhs=r,this.file=o}}class Mn extends qe{constructor(e,s,n,i,r){super(b.Tag,[s,n],e,s,n,!1,!1,r),this.tokenizer=new P(e,i.operators,r,this.contentRange),this.name=this.tokenizer.readTagName(),this.tokenizer.assert(this.name,"illegal liquid tag syntax"),this.tokenizer.skipBlank()}get args(){return this.tokenizer.input.slice(this.tokenizer.p,this.contentRange[1])}}class An extends V{constructor(e,s,n,i,r,o){super(b.FilteredValue,n,i,r,o),this.initial=e,this.filters=s,this.input=n,this.begin=i,this.end=r,this.file=o}}const Pn={now:()=>Date.now()};function ss(){return typeof global=="object"&&global.performance||typeof window=="object"&&window.performance||Pn}class qn{renderTemplatesToNodeStream(e,s){const n=new hn;return Promise.resolve().then(()=>q(this.renderTemplates(e,s,n))).then(()=>n.end(),i=>n.error(i)),n.stream}*renderTemplates(e,s,n){n||(n=s.opts.keepOutputType?new dn:new Jt);const i=[];for(const r of e){s.renderLimit.check(ss().now());try{const o=yield r.render(s,n);if(o&&n.write(o),s.breakCalled||s.continueCalled)break}catch(o){const a=Q.is(o)?o:new Ks(o,r);if(s.opts.catchAllErrors)i.push(a);else throw a}}if(i.length)throw new Zt(i);return n.buffer}}class Dn{constructor(e){this.postfix=[...Bn(e)]}*evaluate(e,s){F(e,"unable to evaluate: context not defined");const n=[];for(const i of this.postfix)if(cs(i)){const r=n.pop();let o;if(Fn[i.operator]===1)o=yield e.opts.operators[i.operator](r,e);else{const a=n.pop();o=yield e.opts.operators[i.operator](a,r,e)}n.push(o)}else n.push(yield x(i,e,s));return n[0]}valid(){return!!this.postfix.length}}function*x(t,e,s=!1){if(t){if("content"in t)return t.content;if(we(t))return yield jn(t,e,s);if(us(t))return yield In(t,e)}}function*jn(t,e,s){const n=[];for(const i of t.props)n.push(yield x(i,e,!1));try{if(t.variable){const i=yield x(t.variable,e,s);return yield e._getFromScope(i,n)}else return yield e._get(n)}catch(i){if(s&&i.name==="InternalUndefinedVariableError")return null;throw new en(i,t)}}function $n(t){return t.content}function*In(t,e){const s=yield x(t.lhs,e),n=yield x(t.rhs,e);return e.memoryLimit.use(n-s+1),Ut(+s,+n+1)}function*Bn(t){const e=[];for(const s of t)if(cs(s)){for(;e.length&&e[e.length-1].getPrecedence()>s.getPrecedence();)yield e.pop();e.push(s)}else yield s;for(;e.length;)yield e.pop()}function H(t,e){return!Te(t,e)}function Te(t,e){return t=g(t),e.opts.jsTruthy?!t:t===!1||t===void 0||t===null}const Un={"==":j,"!=":(t,e)=>!j(t,e),">":(t,e)=>A(t)?t.gt(e):A(e)?e.lt(t):g(t)>g(e),"<":(t,e)=>A(t)?t.lt(e):A(e)?e.gt(t):g(t)<g(e),">=":(t,e)=>A(t)?t.geq(e):A(e)?e.leq(t):g(t)>=g(e),"<=":(t,e)=>A(t)?t.leq(e):A(e)?e.geq(t):g(t)<=g(e),contains:(t,e)=>(t=g(t),L(t)?t.some(s=>j(s,e)):S(t?.indexOf)?t.indexOf(g(e))>-1:!1),not:(t,e)=>Te(g(t),e),and:(t,e,s)=>H(g(t),s)&&H(g(e),s),or:(t,e,s)=>H(g(t),s)||H(g(e),s)};function j(t,e){return A(t)?t.equals(e):A(e)?e.equals(t):(t=g(t),e=g(e),L(t)?L(e)&&Hn(t,e):t===e)}function Hn(t,e){return t.length!==e.length?!1:!t.some((s,n)=>!j(s,e[n]))}function Wn(t,e){return t.some(s=>j(s,e))}class _e{constructor(e,s,n,i){this.key=e,this.value=s,this.next=n,this.prev=i}}class wt{constructor(e,s=0){this.limit=e,this.size=s,this.cache={},this.head=new _e("HEAD",null,null,null),this.tail=new _e("TAIL",null,null,null),this.head.next=this.tail,this.tail.prev=this.head}write(e,s){if(this.cache[e])this.cache[e].value=s;else{const n=new _e(e,s,this.head.next,this.head);this.head.next.prev=n,this.head.next=n,this.cache[e]=n,this.size++,this.ensureLimit()}}read(e){if(!this.cache[e])return;const{value:s}=this.cache[e];return this.remove(e),this.write(e,s),s}remove(e){const s=this.cache[e];s.prev.next=s.next,s.next.prev=s.prev,delete this.cache[e],this.size--}clear(){this.head.next=this.tail,this.tail.prev=this.head,this.size=0,this.cache={}}ensureLimit(){this.size>this.limit&&this.remove(this.tail.prev.key)}}function ns(t,e){const s=document.createElement("base");s.href=t;const n=document.getElementsByTagName("head")[0];n.insertBefore(s,n.firstChild);const i=document.createElement("a");i.href=e;const r=i.href;return n.removeChild(s),r}function Zn(t,e,s){return t.length&&Bt(t)!=="/"&&(t+="/"),ns(t,e).replace(/^(\w+:\/\/[^/]+)(\/[^?]+)/,(i,r,o)=>{const a=o.split("/").pop();return/\.\w+$/.test(a)?i:r+o+s})}function Yn(t){return _(this,void 0,void 0,function*(){return new Promise((e,s)=>{const n=new XMLHttpRequest;n.onload=()=>{n.status>=200&&n.status<300?e(n.responseText):s(new Error(n.statusText))},n.onerror=()=>{s(new Error("An error occurred whilst receiving the response."))},n.open("GET",t),n.send()})})}function Jn(t){const e=new XMLHttpRequest;if(e.open("GET",t,!1),e.send(),e.status<200||e.status>=300)throw new Error(e.statusText);return e.responseText}function Qn(t){return _(this,void 0,void 0,function*(){return!0})}function Gn(t){return!0}function Xn(t){return ns(t,".")}const Kn="/";var ei=Object.freeze({__proto__:null,resolve:Zn,readFile:Yn,readFileSync:Jn,exists:Qn,existsSync:Gn,dirname:Xn,sep:Kn});function ti(t,e,...s){return t=g(t),L(t)||m(t)?t.length?t:e:t===!1&&new Map(s).get("allow_false")?!1:Te(t,this.context)?e:t}function bt(t,e=0){return JSON.stringify(t,null,e)}function si(t,e=0){const s=[];return JSON.stringify(t,function(n,i){if(typeof i!="object"||i===null)return i;for(;s.length>0&&s[s.length-1]!==this;)s.pop();return s.includes(i)?"[Circular]":(s.push(i),i)},e)}function ni(t){return Number(t)}const ii={raw:!0,handler:Wt};var is={default:ti,raw:ii,jsonify:bt,to_integer:ni,json:bt,inspect:si};const ri={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},oi={"&amp;":"&","&lt;":"<","&gt;":">","&#34;":'"',"&#39;":"'"};function xe(t){return t=d(t),this.context.memoryLimit.use(t.length),t.replace(/&|<|>|"|'/g,e=>ri[e])}function ai(t){return xe.call(this,t)}function li(t){return t=d(t),this.context.memoryLimit.use(t.length),t.replace(/&(amp|lt|gt|#34|#39);/g,e=>oi[e])}function ci(t){return xe.call(this,li.call(this,t))}function ui(t){const e=d(t);return this.context.memoryLimit.use(e.length),e.replace(/\r?\n/gm,`<br />
`)}function hi(t){const e=d(t);return this.context.memoryLimit.use(e.length),e.replace(/<script[\s\S]*?<\/script>|<style[\s\S]*?<\/style>|<.*?>|<!--[\s\S]*?-->/g,"")}var di=Object.freeze({__proto__:null,escape:xe,xml_escape:ai,escape_once:ci,newline_to_br:ui,strip_html:hi});class fi{constructor(e){this.mapping=e,this.sep="/"}exists(e){return _(this,void 0,void 0,function*(){return this.existsSync(e)})}existsSync(e){return!N(this.mapping[e])}readFile(e){return _(this,void 0,void 0,function*(){return this.readFileSync(e)})}readFileSync(e){const s=this.mapping[e];if(N(s))throw new Error(`ENOENT: ${e}`);return s}dirname(e){const s=e.split(this.sep);return s.pop(),s.join(this.sep)}resolve(e,s,n){if(s+=n,e===".")return s;const i=e.split(/\/+/);for(const r of s.split(this.sep))r==="."||r===""||(r===".."?(i.length>1||i[0]!=="")&&i.pop():i.push(r));return i.join(this.sep)}}const K={root:["."],layouts:["."],partials:["."],relativeReference:!0,jekyllInclude:!1,keyValueSeparator:":",cache:void 0,extname:"",fs:ei,dynamicPartials:!0,jsTruthy:!1,dateFormat:"%A, %B %-e, %Y at %-l:%M %P %z",locale:"",trimTagRight:!1,trimTagLeft:!1,trimOutputRight:!1,trimOutputLeft:!1,greedy:!0,tagDelimiterLeft:"{%",tagDelimiterRight:"%}",outputDelimiterLeft:"{{",outputDelimiterRight:"}}",preserveTimezones:!1,strictFilters:!1,strictVariables:!1,ownPropertyOnly:!0,lenientIf:!1,globals:{},keepOutputType:!1,operators:Un,memoryLimit:1/0,parseLimit:1/0,renderLimit:1/0};function pi(t){var e,s;if(t.hasOwnProperty("root")&&(t.hasOwnProperty("partials")||(t.partials=t.root),t.hasOwnProperty("layouts")||(t.layouts=t.root)),t.hasOwnProperty("cache")){let n;typeof t.cache=="number"?n=t.cache>0?new wt(t.cache):void 0:typeof t.cache=="object"?n=t.cache:n=t.cache?new wt(1024):void 0,t.cache=n}return t=Object.assign(Object.assign(Object.assign({},K),t.jekyllInclude?{dynamicPartials:!1}:{}),t),(!t.fs.dirname||!t.fs.sep)&&t.relativeReference&&(console.warn("[LiquidJS] `fs.dirname` and `fs.sep` are required for relativeReference, set relativeReference to `false` to suppress this warning"),t.relativeReference=!1),t.root=de(t.root),t.partials=de(t.partials),t.layouts=de(t.layouts),t.outputEscape=t.outputEscape&&mi(t.outputEscape),t.locale||(t.locale=(s=(e=Xt())===null||e===void 0?void 0:e().resolvedOptions().locale)!==null&&s!==void 0?s:"en-US"),t.templates&&(t.fs=new fi(t.templates),t.relativeReference=!0,t.root=t.partials=t.layouts="."),t}function mi(t){return t==="escape"?xe:t==="json"?is.json:(F(S(t),"`outputEscape` need to be of type string or function"),t)}function de(t){let e=[];return L(t)&&(e=t),m(t)&&(e=[t]),e}function gi(t,e){let s=!1;for(let n=0;n<t.length;n++){const i=t[n];Si(i)&&(!s&&i.trimLeft&&yi(t[n-1],e.greedy),G(i)&&(i.name==="raw"?s=!0:i.name==="endraw"&&(s=!1)),!s&&i.trimRight&&wi(t[n+1],e.greedy))}}function yi(t,e){if(!t||!je(t))return;const s=e?te:Yt;for(;y[t.input.charCodeAt(t.end-1-t.trimRight)]&s;)t.trimRight++}function wi(t,e){if(!t||!je(t))return;const s=e?te:Yt;for(;y[t.input.charCodeAt(t.begin+t.trimLeft)]&s;)t.trimLeft++;t.input.charAt(t.begin+t.trimLeft)===`
`&&t.trimLeft++}class P{constructor(e,s=K.operators,n,i){this.input=e,this.file=n,this.rawBeginAt=-1,this.p=i?i[0]:0,this.N=i?i[1]:e.length,this.opTrie=lt(s),this.literalTrie=lt(Qt)}readExpression(){return new Dn(this.readExpressionTokens())}*readExpressionTokens(){for(;this.p<this.N;){const e=this.readOperator();if(e){yield e;continue}const s=this.readValue();if(s){yield s;continue}return}}readOperator(){this.skipBlank();const e=this.matchTrie(this.opTrie);if(e!==-1)return new Rn(this.input,this.p,this.p=e,this.file)}matchTrie(e){let s=e,n=this.p,i;for(;s[this.input[n]]&&n<this.N;)s=s[this.input[n++]],s.end&&(i=s);return!i||i.needBoundary&&ue(this.peek(n-this.p))?-1:n}readFilteredValue(){const e=this.p,s=this.readExpression();this.assert(s.valid(),`invalid value expression: ${this.snapshot()}`);const n=this.readFilters();return new An(s,n,this.input,e,this.p,this.file)}readFilters(){const e=[];for(;;){const s=this.readFilter();if(!s)return e;e.push(s)}}readFilter(){if(this.skipBlank(),this.end())return null;this.assert(this.read()==="|",'expected "|" before filter');const e=this.readIdentifier();if(!e.size())return this.assert(this.end(),"expected filter name"),null;const s=[];if(this.skipBlank(),this.peek()===":")do{++this.p;const n=this.readFilterArg();n&&s.push(n),this.skipBlank(),this.assert(this.end()||this.peek()===","||this.peek()==="|",()=>`unexpected character ${this.snapshot()}`)}while(this.peek()===",");else if(!(this.peek()==="|"||this.end()))throw this.error('expected ":" after filter name');return new ts(e.getText(),s,this.input,e.begin,this.p,this.file)}readFilterArg(){const e=this.readValue();if(!e)return;if(this.skipBlank(),this.peek()!==":")return e;++this.p;const s=this.readValue();return[e.getText(),s]}readTopLevelTokens(e=K){const s=[];for(;this.p<this.N;){const n=this.readTopLevelToken(e);s.push(n)}return gi(s,e),s}readTopLevelToken(e){const{tagDelimiterLeft:s,outputDelimiterLeft:n}=e;return this.rawBeginAt>-1?this.readEndrawOrRawContent(e):this.match(s)?this.readTagToken(e):this.match(n)?this.readOutputToken(e):this.readHTMLToken([s,n])}readHTMLToken(e){const s=this.p;for(;this.p<this.N&&!e.some(n=>this.match(n));)++this.p;return new dt(this.input,s,this.p,this.file)}readTagToken(e){const{file:s,input:n}=this,i=this.p;if(this.readToDelimiter(e.tagDelimiterRight)===-1)throw this.error(`tag ${this.snapshot(i)} not closed`,i);const r=new ht(n,i,this.p,e,s);return r.name==="raw"&&(this.rawBeginAt=i),r}readToDelimiter(e,s=!1){for(this.skipBlank();this.p<this.N;){if(s&&this.peekType()&rt){this.readQuoted();continue}if(++this.p,this.rmatch(e))return this.p}return-1}readOutputToken(e=K){const{file:s,input:n}=this,{outputDelimiterRight:i}=e,r=this.p;if(this.readToDelimiter(i,!0)===-1)throw this.error(`output ${this.snapshot(r)} not closed`,r);return new Sn(n,r,this.p,e,s)}readEndrawOrRawContent(e){const{tagDelimiterLeft:s,tagDelimiterRight:n}=e,i=this.p;let r=this.readTo(s)-s.length;for(;this.p<this.N;){if(this.readIdentifier().getText()!=="endraw"){r=this.readTo(s)-s.length;continue}for(;this.p<=this.N;){if(this.rmatch(n)){const o=this.p;return i===r?(this.rawBeginAt=-1,new ht(this.input,i,o,e,this.file)):(this.p=r,new dt(this.input,i,r,this.file))}if(this.rmatch(s))break;this.p++}}throw this.error(`raw ${this.snapshot(this.rawBeginAt)} not closed`,i)}readLiquidTagTokens(e=K){const s=[];for(;this.p<this.N;){const n=this.readLiquidTagToken(e);n&&s.push(n)}return s}readLiquidTagToken(e){if(this.skipBlank(),this.end())return;const s=this.p;this.readToDelimiter(`
`);const n=this.p;return new Mn(this.input,s,n,e,this.file)}error(e,s=this.p){return new Gs(e,new ve(this.input,s,this.N,this.file))}assert(e,s,n){if(!e)throw this.error(typeof s=="function"?s():s,n)}snapshot(e=this.p){return JSON.stringify(Qs(this.input.slice(e,this.N),32))}readWord(){return this.readIdentifier()}readIdentifier(){this.skipBlank();const e=this.p;for(;!this.end()&&ue(this.peek());)++this.p;return new ve(this.input,e,this.p,this.file)}readNonEmptyIdentifier(){const e=this.readIdentifier();return e.size()?e:void 0}readTagName(){return this.skipBlank(),this.input[this.p]==="#"?this.input.slice(this.p,++this.p):this.readIdentifier().getText()}readHashes(e){const s=[];for(;;){const n=this.readHash(e);if(!n)return s;s.push(n)}}readHash(e){this.skipBlank(),this.peek()===","&&++this.p;const s=this.p,n=this.readNonEmptyIdentifier();if(!n)return;let i;this.skipBlank();const r=m(e)?e:e?"=":":";return this.peek()===r&&(++this.p,i=this.readValue()),new En(this.input,s,this.p,n,i,this.file)}remaining(){return this.input.slice(this.p,this.N)}advance(e=1){this.p+=e}end(){return this.p>=this.N}read(){return this.input[this.p++]}readTo(e){for(;this.p<this.N;)if(++this.p,this.rmatch(e))return this.p;return-1}readValue(){this.skipBlank();const e=this.p,s=this.readLiteral()||this.readQuoted()||this.readRange()||this.readNumber(),n=this.readProperties(!s);return n.length?new pt(s,n,this.input,e,this.p):s}readScopeValue(){this.skipBlank();const e=this.p,s=this.readProperties();if(s.length)return new pt(void 0,s,this.input,e,this.p)}readProperties(e=!0){const s=[];for(;;){if(this.peek()==="["){this.p++;const n=this.readValue()||new ve(this.input,this.p,this.p,this.file);this.assert(this.readTo("]")!==-1,"[ not closed"),s.push(n);continue}if(e&&!s.length){const n=this.readNonEmptyIdentifier();if(n){s.push(n);continue}}if(this.peek()==="."&&this.peek(1)!=="."){this.p++;const n=this.readNonEmptyIdentifier();if(!n)break;s.push(n);continue}break}return s}readNumber(){this.skipBlank();let e=!1,s=!1,n=0;for(this.peekType()&ln&&n++;this.p+n<=this.N;)if(this.peekType(n)&an)s=!0,n++;else if(this.peek(n)==="."&&this.peek(n+1)!=="."){if(e||!s)return;e=!0,n++}else break;if(s&&!ue(this.peek(n))){const i=new On(this.input,this.p,this.p+n,this.file);return this.advance(n),i}}readLiteral(){this.skipBlank();const e=this.matchTrie(this.literalTrie);if(e===-1)return;const s=new Ln(this.input,this.p,e,this.file);return this.p=e,s}readRange(){this.skipBlank();const e=this.p;if(this.peek()!=="(")return;++this.p;const s=this.readValueOrThrow();this.skipBlank(),this.assert(this.read()==="."&&this.read()===".","invalid range syntax");const n=this.readValueOrThrow();return this.skipBlank(),this.assert(this.read()===")","invalid range syntax"),new Cn(this.input,e,this.p,s,n,this.file)}readValueOrThrow(){const e=this.readValue();return this.assert(e,()=>`unexpected token ${this.snapshot()}, value expected`),e}readQuoted(){this.skipBlank();const e=this.p;if(!(this.peekType()&rt))return;++this.p;let s=!1;for(;this.p<this.N&&(++this.p,!(this.input[this.p-1]===this.input[e]&&!s));)s?s=!1:this.input[this.p-1]==="\\"&&(s=!0);return new Vn(this.input,e,this.p,this.file)}*readFileNameTemplate(e){const{outputDelimiterLeft:s}=e,n=[","," ",s],i=new Set(n);for(;this.p<this.N&&!i.has(this.peek());)yield this.match(s)?this.readOutputToken(e):this.readHTMLToken(n)}match(e){for(let s=0;s<e.length;s++)if(e[s]!==this.input[this.p+s])return!1;return!0}rmatch(e){for(let s=0;s<e.length;s++)if(e[e.length-1-s]!==this.input[this.p-1-s])return!1;return!0}peekType(e=0){return this.p+e>=this.N?0:y[this.input.charCodeAt(this.p+e)]}peek(e=0){return this.p+e>=this.N?"":this.input[this.p+e]}skipBlank(){for(;this.peekType()&te;)++this.p}}class bi{constructor(e,s){this.handlers={},this.stopRequested=!1,this.tokens=e,this.parseToken=s}on(e,s){return this.handlers[e]=s,this}trigger(e,s){const n=this.handlers[e];return n?(n.call(this,s),!0):!1}start(){this.trigger("start");let e;for(;!this.stopRequested&&(e=this.tokens.shift());){if(this.trigger("token",e)||G(e)&&this.trigger(`tag:${e.name}`,e))continue;const s=this.parseToken(e,this.tokens);this.trigger("template",s)}return this.stopRequested||this.trigger("end"),this}stop(){return this.stopRequested=!0,this}}class De{constructor(e){this.token=e}}class k extends De{constructor(e,s,n){super(e),this.name=e.name,this.liquid=n,this.tokenizer=e.tokenizer}}class ne{constructor(e,s){this.hash={};const n=e instanceof P?e:new P(e,{});for(const i of n.readHashes(s))this.hash[i.name.content]=i.value}*render(e){const s={};for(const n of Object.keys(this.hash))s[n]=this.hash[n]===void 0?!0:yield x(this.hash[n],e);return s}}function ki(t){return class extends k{constructor(e,s,n){super(e,s,n),S(t.parse)&&t.parse.call(this,e,s)}*render(e,s){const n=yield new ne(this.token.args,e.opts.keyValueSeparator).render(e);return yield t.render.call(this,e,s,n)}}}function rs(t){return L(t)}class os{constructor(e,s,n){this.token=e,this.name=e.name,this.handler=S(s)?s:S(s?.handler)?s.handler:Wt,this.raw=!S(s)&&!!s?.raw,this.args=e.args,this.liquid=n}*render(e,s){const n=[];for(const i of this.args)rs(i)?n.push([i[0],yield x(i[1],s)]):n.push(yield x(i,s));return yield this.handler.apply({context:s,token:this.token,liquid:this.liquid},[e,...n])}}class E{constructor(e,s){this.filters=[];const n=typeof e=="string"?new P(e,s.options.operators).readFilteredValue():e;this.initial=n.initial,this.filters=n.filters.map(i=>new os(i,this.getFilter(s,i.name),s))}*value(e,s){s=s||e.opts.lenientIf&&this.filters.length>0&&this.filters[0].name==="default";let n=yield this.initial.evaluate(e,s);for(const i of this.filters)n=yield i.render(n,e);return n}getFilter(e,s){const n=e.filters[s];return F(n||!e.options.strictFilters,()=>`undefined filter: ${s}`),n}}class Ti extends De{constructor(e,s){var n;super(e);const i=new P(e.input,s.options.operators,e.file,e.contentRange);this.value=new E(i.readFilteredValue(),s);const r=this.value.filters,o=s.options.outputEscape;if(!(!((n=r[r.length-1])===null||n===void 0)&&n.raw)&&o){const a=new ts(toString.call(o),[],"",0,0);r.push(new os(a,o,s))}}*render(e,s){const n=yield this.value.value(e,!1);s.write(n)}*arguments(){yield this.value}}class xi extends De{constructor(e){super(e),this.str=e.getContent()}*render(e,s){s.write(this.str)}}class Z{constructor(e,s){this.segments=e,this.location=s}toString(){return ye(this.segments,!0)}toArray(){function*e(...s){for(const n of s)n instanceof Z?yield Array.from(e(...n.segments)):yield n}return Array.from(e(...this.segments))}}class Se{constructor(){this.map=new Map}get(e){const s=ye([e.segments[0]]);return this.map.has(s)||this.map.set(s,[]),this.map.get(s)}has(e){return this.map.has(ye([e.segments[0]]))}push(e){this.get(e).push(e)}asObject(){return Object.fromEntries(this.map)}}const as={partials:!0};function*ls(t,e,s){const n=new Se,i=new Se,r=new Se,o=new kt(new Set),a=new Set;function c(l,h){n.push(l);const p=h.alias(l);if(p!==void 0){const f=p.segments[0];m(f)&&!o.has(f)&&i.push(p)}else{const f=l.segments[0];m(f)&&!h.has(f)&&i.push(l)}for(const f of l.segments)f instanceof Z&&c(f,h)}function*u(l,h){if(l.arguments)for(const p of l.arguments())for(const f of Tt(p))c(f,h);if(l.localScope)for(const p of l.localScope()){h.add(p.content),h.deleteAlias(p.content);const[f,T]=p.getPosition();r.push(new Z([p.content],{row:f,col:T,file:p.file}))}if(l.children)if(l.partialScope){const p=l.partialScope();if(p===void 0){for(const w of yield l.children(e,s))yield u(w,h);return}if(a.has(p.name))return;const f=new Set,T=p.isolated?new kt(f):h.push(f);for(const w of p.scope)if(m(w))f.add(w);else{const[v,le]=w;f.add(v);const We=Array.from(Tt(le));We.length&&T.setAlias(v,We[0].segments)}for(const w of yield l.children(e,s))yield u(w,T),a.add(p.name);T.pop()}else{l.blockScope&&h.push(new Set(l.blockScope()));for(const p of yield l.children(e,s))yield u(p,h);l.blockScope&&h.pop()}}for(const l of t)yield u(l,o);return{variables:n.asObject(),globals:i.asObject(),locals:r.asObject()}}function $(t,e={}){const s=Object.assign(Object.assign({},as),e);return q(ls(t,s.partials,!1))}function I(t,e={}){const s=Object.assign(Object.assign({},as),e);return D(ls(t,s.partials,!0))}class kt{constructor(e){this.stack=[{names:e,aliases:new Map}]}has(e){for(const s of this.stack)if(s.names.has(e))return!0;return!1}push(e){return this.stack.push({names:e,aliases:new Map}),this}pop(){var e;return(e=this.stack.pop())===null||e===void 0?void 0:e.names}add(e){this.stack[0].names.add(e)}alias(e){const s=e.segments[0];if(!m(s))return;const n=this.getAlias(s);if(n!==void 0)return new Z([...n,...e.segments.slice(1)],e.location)}setAlias(e,s){this.stack[this.stack.length-1].aliases.set(e,s)}deleteAlias(e){this.stack[this.stack.length-1].aliases.delete(e)}getAlias(e){for(const s of this.stack){if(s.aliases.has(e))return s.aliases.get(e);if(s.names.has(e))return}}}function*Tt(t){R(t)?yield*ee(t):t instanceof E&&(yield*vi(t))}function*vi(t){for(const e of t.initial.postfix)R(e)&&(yield*ee(e));for(const e of t.filters)for(const s of e.args)rs(s)&&s[1]?yield*ee(s[1]):R(s)&&(yield*ee(s))}function*ee(t){us(t)?(yield*ee(t.lhs),yield*ee(t.rhs)):we(t)&&(yield Ee(t))}function Ee(t){const e=[];let s=t.file;const n=t.props[0];s=s||n.file,ze(n)||vt(n)||_t(n)?e.push(n.content):we(n)&&e.push(...Ee(n).segments);for(const o of t.props.slice(1))s=s||o.file,ze(o)||vt(o)||_t(o)?e.push(o.content):we(o)&&e.push(Ee(o));const[i,r]=t.getPosition();return new Z(e,{row:i,col:r,file:s})}const xt=/^[\u0080-\uFFFFa-zA-Z_][\u0080-\uFFFFa-zA-Z0-9_-]*$/;function ye(t,e=!1){const s=[],n=t[0];m(n)&&(!e||n.match(xt)?s.push(`${n}`):s.push(`['${n}']`));for(const i of t.slice(1))i instanceof Z?s.push(`[${ye(i.segments)}]`):m(i)?i.match(xt)?s.push(`.${i}`):s.push(`['${i}']`):s.push(`[${i}]`);return s.join("")}var Y;(function(t){t.Partials="partials",t.Layouts="layouts",t.Root="root"})(Y||(Y={}));class _i{constructor(e){if(this.options=e,e.relativeReference){const s=e.fs.sep;F(s,"`fs.sep` is required for relative reference");const n=new RegExp(["."+s,".."+s,"./","../"].map(i=>Hs(i)).join("|"));this.shouldLoadRelative=i=>n.test(i)}else this.shouldLoadRelative=s=>!1;this.contains=this.options.fs.contains||(()=>!0)}*lookup(e,s,n,i){const{fs:r}=this.options,o=this.options[s];for(const a of this.candidates(e,o,i,s!==Y.Root))if(n?r.existsSync(a):yield r.exists(a))return a;throw this.lookupError(e,o)}*candidates(e,s,n,i){const{fs:r,extname:o}=this.options;if(this.shouldLoadRelative(e)&&n){const a=r.resolve(this.dirname(n),e,o);for(const c of s)if(!i||this.contains(c,a)){yield a;break}}for(const a of s){const c=r.resolve(a,e,o);(!i||this.contains(a,c))&&(yield c)}if(r.fallback!==void 0){const a=r.fallback(e);a!==void 0&&(yield a)}}dirname(e){const s=this.options.fs;return F(s.dirname,"`fs.dirname` is required for relative reference"),s.dirname(e)}lookupError(e,s){const n=new Error("ENOENT");return n.message=`ENOENT: Failed to lookup "${e}" in "${s}"`,n.code="ENOENT",n}}class B{constructor(e){this.liquid=e,this.cache=this.liquid.options.cache,this.fs=this.liquid.options.fs,this.parseFile=this.cache?this._parseFileCached:this._parseFile,this.loader=new _i(this.liquid.options),this.parseLimit=new Re("parse length",e.options.parseLimit)}parse(e,s){e=String(e),this.parseLimit.use(e.length);const i=new P(e,this.liquid.options.operators,s).readTopLevelTokens(this.liquid.options);return this.parseTokens(i)}parseTokens(e){let s;const n=[],i=[];for(;s=e.shift();)try{n.push(this.parseToken(s,e))}catch(r){if(this.liquid.options.catchAllErrors)i.push(r);else throw r}if(i.length)throw new Zt(i);return n}parseToken(e,s){try{if(G(e)){const n=this.liquid.tags[e.name];return F(n,`tag "${e.name}" not found`),new n(e,s,this.liquid,this)}return Oi(e)?new Ti(e,this.liquid):new xi(e)}catch(n){throw Q.is(n)?n:new Xs(n,e)}}parseStream(e){return new bi(e,(s,n)=>this.parseToken(s,n))}*_parseFileCached(e,s,n=Y.Root,i){const r=this.cache,o=this.loader.shouldLoadRelative(e)?i+","+e:n+":"+e,a=yield r.read(o);if(a)return a;const c=this._parseFile(e,s,n,i),u=s?yield c:q(c);r.write(o,u);try{return yield u}catch(l){throw r.remove(o),l}}*_parseFile(e,s,n=Y.Root,i){const r=yield this.loader.lookup(e,n,s,i);return this.parse(s?this.fs.readFileSync(r):yield this.fs.readFile(r),r)}}var b;(function(t){t[t.Number=1]="Number",t[t.Literal=2]="Literal",t[t.Tag=4]="Tag",t[t.Output=8]="Output",t[t.HTML=16]="HTML",t[t.Filter=32]="Filter",t[t.Hash=64]="Hash",t[t.PropertyAccess=128]="PropertyAccess",t[t.Word=256]="Word",t[t.Range=512]="Range",t[t.Quoted=1024]="Quoted",t[t.Operator=2048]="Operator",t[t.FilteredValue=4096]="FilteredValue",t[t.Delimited=12]="Delimited"})(b||(b={}));function Si(t){return!!(M(t)&b.Delimited)}function cs(t){return M(t)===b.Operator}function je(t){return M(t)===b.HTML}function Oi(t){return M(t)===b.Output}function G(t){return M(t)===b.Tag}function ze(t){return M(t)===b.Quoted}function vt(t){return M(t)===b.Number}function we(t){return M(t)===b.PropertyAccess}function _t(t){return M(t)===b.Word}function us(t){return M(t)===b.Range}function R(t){return(M(t)&1667)>0}function M(t){return t?t.kind:-1}class U{constructor(e={},s=K,n={},{memoryLimit:i,renderLimit:r}={}){var o,a,c,u,l;this.scopes=[{}],this.registers={},this.breakCalled=!1,this.continueCalled=!1,this.sync=!!n.sync,this.opts=s,this.globals=(o=n.globals)!==null&&o!==void 0?o:s.globals,this.environments=ke(e)?e:Object(e),this.strictVariables=(a=n.strictVariables)!==null&&a!==void 0?a:this.opts.strictVariables,this.ownPropertyOnly=(c=n.ownPropertyOnly)!==null&&c!==void 0?c:s.ownPropertyOnly,this.memoryLimit=i??new Re("memory alloc",(u=n.memoryLimit)!==null&&u!==void 0?u:s.memoryLimit),this.renderLimit=r??new Re("template render",ss().now()+((l=n.renderLimit)!==null&&l!==void 0?l:s.renderLimit))}getRegister(e){return this.registers[e]=this.registers[e]||{}}setRegister(e,s){return this.registers[e]=s}saveRegister(...e){return e.map(s=>[s,this.getRegister(s)])}restoreRegister(e){return e.forEach(([s,n])=>this.setRegister(s,n))}getAll(){return[this.globals,this.environments,...this.scopes].reduce((e,s)=>ge(e,s),{})}get(e){return this.getSync(e)}getSync(e){return D(this._get(e))}*_get(e){const s=this.findScope(e[0]);return yield this._getFromScope(s,e)}getFromScope(e,s){return D(this._getFromScope(e,s))}*_getFromScope(e,s,n=this.strictVariables){m(s)&&(s=s.split("."));for(let i=0;i<s.length;i++)if(e=yield Li(e,s[i],this.ownPropertyOnly),n&&Ws(e))throw new tn(s.slice(0,i+1).join("."));return e}push(e){return this.scopes.push(e)}pop(){return this.scopes.pop()}bottom(){return this.scopes[0]}spawn(e={}){return new U(e,this.opts,{sync:this.sync,globals:this.globals,strictVariables:this.strictVariables},{renderLimit:this.renderLimit,memoryLimit:this.memoryLimit})}findScope(e){for(let s=this.scopes.length-1;s>=0;s--){const n=this.scopes[s];if(e in n)return n}return e in this.environments?this.environments:this.globals}}function Li(t,e,s){if(t=$t(t),e=g(e),N(t))return t;if(L(t)&&e<0)return t[t.length+ +e];const n=Fi(t,e,s);return n===void 0&&t instanceof J?t.liquidMethodMissing(e):S(n)?n.call(t):e==="size"?zi(t):e==="first"?Ri(t):e==="last"?Ei(t):n}function Fi(t,e,s){if(!(s&&!Ce.call(t,e)&&!(t instanceof J)))return t[e]}function Ri(t){return L(t)?t[0]:t.first}function Ei(t){return L(t)?t[t.length-1]:t.last}function zi(t){if(Ce.call(t,"size")||t.size!==void 0)return t.size;if(L(t)||m(t))return t.length;if(typeof t=="object")return Object.keys(t).length}var W;(function(t){t[t.OUTPUT=0]="OUTPUT",t[t.STORE=1]="STORE"})(W||(W={}));const Ni=z(Math.abs),Vi=z(Math.max),Ci=z(Math.min),Mi=z(Math.ceil),Ai=z((t,e,s=!1)=>s?Math.floor(t/e):t/e),Pi=z(Math.floor),qi=z((t,e)=>t-e),Di=z((t,e)=>t%e),ji=z((t,e)=>t*e);function $i(t,e=0){t=g(t),e=g(e);const s=Math.pow(10,e);return Math.round(t*s)/s}function Ii(t,e){return t=g(t),e=g(e),Number(t)+Number(e)}var Bi=Object.freeze({__proto__:null,abs:Ni,at_least:Vi,at_most:Ci,ceil:Mi,divided_by:Ai,floor:Pi,minus:qi,modulo:Di,times:ji,round:$i,plus:Ii});const Ui=t=>decodeURIComponent(d(t)).replace(/\+/g," "),Hi=t=>encodeURIComponent(d(t)).replace(/%20/g,"+"),Wi=t=>encodeURIComponent(d(t)).replace(/%20/g,"+").replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()),Zi=t=>encodeURI(d(t)).replace(/%5B/g,"[").replace(/%5D/g,"]"),St=/[^\p{M}\p{L}\p{Nd}]+/ug,Yi={raw:/\s+/g,default:St,pretty:/[^\p{M}\p{L}\p{Nd}._~!$&'()+,;=@]+/ug,ascii:/[^A-Za-z0-9]+/g,latin:St,none:null};function Ji(t,e="default",s=!1){t=d(t);const n=Yi[e];return n&&(e==="latin"&&(t=Qi(t)),t=t.replace(n,"-").replace(/^-|-$/g,"")),s?t:t.toLowerCase()}function Qi(t){return t.replace(/[àáâãäå]/g,"a").replace(/[æ]/g,"ae").replace(/[ç]/g,"c").replace(/[èéêë]/g,"e").replace(/[ìíîï]/g,"i").replace(/[ð]/g,"d").replace(/[ñ]/g,"n").replace(/[òóôõöø]/g,"o").replace(/[ùúûü]/g,"u").replace(/[ýÿ]/g,"y").replace(/[ß]/g,"ss").replace(/[œ]/g,"oe").replace(/[þ]/g,"th").replace(/[ẞ]/g,"SS").replace(/[Œ]/g,"OE").replace(/[Þ]/g,"TH")}var Gi=Object.freeze({__proto__:null,url_decode:Ui,url_encode:Hi,cgi_escape:Wi,uri_escape:Zi,slugify:Ji});const Xi=z(function(t,e){const s=O(t),n=N(e)?" ":d(e),i=s.length*(1+n.length);return this.context.memoryLimit.use(i),s.join(n)}),Ki=z(t=>It(t)?Bt(t):""),er=z(t=>It(t)?t[0]:""),tr=z(function(t){const e=O(t);return this.context.memoryLimit.use(e.length),[...e].reverse()});function*sr(t,e){const s=[],n=O(t);this.context.memoryLimit.use(n.length);for(const i of n)s.push([i,e?yield this.context._getFromScope(i,d(e).split("."),!1):i]);return s.sort((i,r)=>{const o=i[1],a=r[1];return o<a?-1:o>a?1:0}).map(i=>i[0])}function nr(t,e){const s=d(e),n=e===void 0?nt:(r,o)=>nt(r[s],o[s]),i=O(t);return this.context.memoryLimit.use(i.length),[...i].sort(n)}const ir=t=>t&&t.length||0;function*rr(t,e){const s=[],n=O(t);this.context.memoryLimit.use(n.length);for(const i of n)s.push(yield this.context._getFromScope(i,d(e),!1));return s}function*or(t,e){let s=0;const n=O(t);for(const i of n){const r=Number(e?yield this.context._getFromScope(i,d(e),!1):i);s+=Number.isNaN(r)?0:r}return s}function ar(t){const e=O(t);return this.context.memoryLimit.use(e.length),e.filter(s=>!N(g(s)))}function hs(t,e=[]){const s=O(t),n=O(e);return this.context.memoryLimit.use(s.length+n.length),s.concat(n)}function lr(t,e){return hs.call(this,t,[e])}function cr(t,e){const s=O(t);this.context.memoryLimit.use(s.length);const n=[...s];return n.unshift(e),n}function ur(t){const e=[...O(t)];return e.pop(),e}function hr(t){const e=O(t);this.context.memoryLimit.use(e.length);const s=[...e];return s.shift(),s}function dr(t,e,s=1){return t=g(t),N(t)?[]:(L(t)||(t=d(t)),e=e<0?t.length+e:e,this.context.memoryLimit.use(s),t.slice(e,e+s))}function ds(t){return this.context.opts.jekyllWhere?e=>se.is(t)?j(e,t):L(e)?Wn(e,t):j(e,t):t===void 0?e=>H(e,this.context):e=>j(e,t)}function*fs(t,e,s,n){const i=[];e=O(e),this.context.memoryLimit.use(e.length);const r=new P(d(s)).readScopeValue();for(const a of e)i.push(yield x(r,this.context.spawn(a)));const o=ds.call(this,n);return e.filter((a,c)=>o(i[c])===t)}function*ps(t,e,s,n){const i=[],r=new E(d(n),this.liquid),o=O(e);this.context.memoryLimit.use(o.length);for(const a of o){this.context.push({[s]:a});const c=yield r.value(this.context);this.context.pop(),c===t&&i.push(a)}return i}function*fr(t,e,s){return yield*fs.call(this,!0,t,e,s)}function*pr(t,e,s){return yield*fs.call(this,!1,t,e,s)}function*mr(t,e,s){return yield*ps.call(this,!0,t,e,s)}function*gr(t,e,s){return yield*ps.call(this,!1,t,e,s)}function*yr(t,e){const s=new Map;t=ae(t);const n=new P(d(e)).readScopeValue();this.context.memoryLimit.use(t.length);for(const i of t){const r=yield x(n,this.context.spawn(i));s.has(r)||s.set(r,[]),s.get(r).push(i)}return[...s.entries()].map(([i,r])=>({name:i,items:r}))}function*wr(t,e,s){const n=new Map,i=new E(d(s),this.liquid);t=ae(t),this.context.memoryLimit.use(t.length);for(const r of t){this.context.push({[e]:r});const o=yield i.value(this.context);this.context.pop(),n.has(o)||n.set(o,[]),n.get(o).push(r)}return[...n.entries()].map(([r,o])=>({name:r,items:o}))}function*$e(t,e,s){const n=new P(d(e)).readScopeValue(),i=O(t),r=ds.call(this,s);for(let o=0;o<i.length;o++){const a=yield x(n,this.context.spawn(i[o]));if(r(a))return[o,i[o]]}}function*Ie(t,e,s){const n=new E(d(s),this.liquid),i=O(t);for(let r=0;r<i.length;r++){this.context.push({[e]:i[r]});const o=yield n.value(this.context);if(this.context.pop(),o)return[r,i[r]]}}function*br(t,e,s){return!!(yield*$e.call(this,t,e,s))}function*kr(t,e,s){return!!(yield*Ie.call(this,t,e,s))}function*Tr(t,e,s){const n=yield*$e.call(this,t,e,s);return n?n[0]:void 0}function*xr(t,e,s){const n=yield*Ie.call(this,t,e,s);return n?n[0]:void 0}function*vr(t,e,s){const n=yield*$e.call(this,t,e,s);return n?n[1]:void 0}function*_r(t,e,s){const n=yield*Ie.call(this,t,e,s);return n?n[1]:void 0}function Sr(t){return t=O(t),this.context.memoryLimit.use(t.length),[...new Set(t)]}function Or(t,e=1){if(t=g(t),N(t))return[];L(t)||(t=d(t)),this.context.memoryLimit.use(e);const s=[...t].sort(()=>Math.random()-.5);return e===1?s[0]:s.slice(0,e)}var Lr=Object.freeze({__proto__:null,join:Xi,last:Ki,first:er,reverse:tr,sort:sr,sort_natural:nr,size:ir,map:rr,sum:or,compact:ar,concat:hs,push:lr,unshift:cr,pop:ur,shift:hr,slice:dr,where:fr,reject:pr,where_exp:mr,reject_exp:gr,group_by:yr,group_by_exp:wr,has:br,has_exp:kr,find_index:Tr,find_index_exp:xr,find:vr,find_exp:_r,uniq:Sr,sample:Or});function Be(t,e,s){var n,i,r;const o=((n=t?.length)!==null&&n!==void 0?n:0)+((i=e?.length)!==null&&i!==void 0?i:0)+((r=s?.length)!==null&&r!==void 0?r:0);this.context.memoryLimit.use(o);const a=gs(t,this.context.opts,s);return a?(e=g(e),e=N(e)?this.context.opts.dateFormat:d(e),he(a,e)):t}function Fr(t){return Be.call(this,t,"%Y-%m-%dT%H:%M:%S%:z")}function Rr(t){return Be.call(this,t,"%a, %d %b %Y %H:%M:%S %z")}function Er(t,e,s){return ms.call(this,t,"%b",e,s)}function zr(t,e,s){return ms.call(this,t,"%B",e,s)}function ms(t,e,s,n){const i=gs(t,this.context.opts);if(!i)return t;if(s==="ordinal"){const r=i.getDate();return n==="US"?he(i,`${e} ${r}%q, %Y`):he(i,`${r}%q ${e} %Y`)}return he(i,`%d ${e} %Y`)}function gs(t,e,s){let n;const i=s??e.timezoneOffset,r=e.locale;return t=g(t),t==="now"||t==="today"?n=new C(Date.now(),r,i):be(t)?n=new C(t*1e3,r,i):m(t)?/^\d+$/.test(t)?n=new C(+t*1e3,r,i):e.preserveTimezones&&s===void 0?n=C.createDateFixedToTimezone(t,r):n=new C(t,r,i):n=new C(t,r,i),n.valid()?n:void 0}var Nr=Object.freeze({__proto__:null,date:Be,date_to_xmlschema:Fr,date_to_rfc822:Rr,date_to_string:Er,date_to_long_string:zr});const Oe=/[\u4E00-\u9FFF\uF900-\uFAFF\u3400-\u4DBF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF]/gu,Ot=/[^\u4E00-\u9FFF\uF900-\uFAFF\u3400-\u4DBF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF\s]+/gu;function Vr(t,e){F(arguments.length===2,"append expect 2 arguments");const s=d(t),n=d(e);return this.context.memoryLimit.use(s.length+n.length),s+n}function Cr(t,e){F(arguments.length===2,"prepend expect 2 arguments");const s=d(t),n=d(e);return this.context.memoryLimit.use(s.length+n.length),n+s}function Mr(t,e){const s=d(t);return this.context.memoryLimit.use(s.length),e?(e=Me(d(e)),s.replace(new RegExp(`^[${e}]+`,"g"),"")):s.replace(/^\s+/,"")}function Ar(t){const e=d(t);return this.context.memoryLimit.use(e.length),e.toLowerCase()}function Pr(t){const e=d(t);return this.context.memoryLimit.use(e.length),d(e).toUpperCase()}function qr(t,e){const s=d(t);return this.context.memoryLimit.use(s.length),s.split(d(e)).join("")}function Dr(t,e){const s=d(t);return this.context.memoryLimit.use(s.length),s.replace(d(e),"")}function jr(t,e){const s=d(t);this.context.memoryLimit.use(s.length);const n=d(e),i=s.lastIndexOf(n);return i===-1?s:s.substring(0,i)+s.substring(i+n.length)}function $r(t,e){return t=d(t),this.context.memoryLimit.use(t.length),e?(e=Me(d(e)),t.replace(new RegExp(`[${e}]+$`,"g"),"")):t.replace(/\s+$/,"")}function Ir(t,e){const s=d(t);this.context.memoryLimit.use(s.length);const n=s.split(d(e));for(;n.length&&n[n.length-1]==="";)n.pop();return n}function Br(t,e){const s=d(t);return this.context.memoryLimit.use(s.length),e?(e=Me(d(e)),s.replace(new RegExp(`^[${e}]+`,"g"),"").replace(new RegExp(`[${e}]+$`,"g"),"")):s.trim()}function Ur(t){const e=d(t);return this.context.memoryLimit.use(e.length),e.replace(/\r?\n/gm,"")}function Hr(t){return t=d(t),this.context.memoryLimit.use(t.length),t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}function Wr(t,e,s){const n=d(t);return this.context.memoryLimit.use(n.length),n.split(d(e)).join(s)}function Zr(t,e,s){const n=d(t);return this.context.memoryLimit.use(n.length),n.replace(d(e),s)}function Yr(t,e,s){const n=d(t);this.context.memoryLimit.use(n.length);const i=d(e),r=n.lastIndexOf(i);if(r===-1)return n;const o=d(s);return n.substring(0,r)+o+n.substring(r+i.length)}function Jr(t,e=50,s="..."){const n=d(t);return this.context.memoryLimit.use(n.length),n.length<=e?t:n.substring(0,e-s.length)+s}function Qr(t,e=15,s="..."){const n=d(t);this.context.memoryLimit.use(n.length);const i=n.split(/\s+/);e<=0&&(e=1);let r=i.slice(0,e).join(" ");return i.length>=e&&(r+=s),r}function Gr(t){const e=d(t);return this.context.memoryLimit.use(e.length),e.replace(/\s+/g," ")}function Xr(t,e){const s=d(t);if(this.context.memoryLimit.use(s.length),t=s.trim(),!t)return 0;switch(e){case"cjk":return(t.match(Oe)||[]).length+(t.match(Ot)||[]).length;case"auto":return Oe.test(t)?t.match(Oe).length+(t.match(Ot)||[]).length:t.split(/\s+/).length;default:return t.split(/\s+/).length}}function Kr(t,e="and"){switch(this.context.memoryLimit.use(t.length),t.length){case 0:return"";case 1:return t[0];case 2:return`${t[0]} ${e} ${t[1]}`;default:return`${t.slice(0,-1).join(", ")}, ${e} ${t[t.length-1]}`}}var eo=Object.freeze({__proto__:null,append:Vr,prepend:Cr,lstrip:Mr,downcase:Ar,upcase:Pr,remove:qr,remove_first:Dr,remove_last:jr,rstrip:$r,split:Ir,strip:Br,strip_newlines:Ur,capitalize:Hr,replace:Wr,replace_first:Zr,replace_last:Yr,truncate:Jr,truncatewords:Qr,normalize_whitespace:Gr,number_of_words:Xr,array_to_sentence_string:Kr});const to=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},di),Bi),Gi),Lr),Nr),eo),is);class so extends k{constructor(e,s,n){super(e,s,n),this.identifier=this.tokenizer.readIdentifier(),this.key=this.identifier.content,this.tokenizer.assert(this.key,"expected variable name"),this.tokenizer.skipBlank(),this.tokenizer.assert(this.tokenizer.peek()==="=",'expected "="'),this.tokenizer.advance(),this.value=new E(this.tokenizer.readFilteredValue(),this.liquid)}*render(e){e.bottom()[this.key]=yield this.value.value(e,this.liquid.options.lenientIf)}*arguments(){yield this.value}*localScope(){yield this.identifier}}const Lt=["offset","limit","reversed"];class no extends k{constructor(e,s,n,i){super(e,s,n);const r=this.tokenizer.readIdentifier(),o=this.tokenizer.readIdentifier(),a=this.tokenizer.readValue();if(!r.size()||o.content!=="in"||!a)throw new Error(`illegal tag: ${e.getText()}`);this.variable=r.content,this.collection=a,this.hash=new ne(this.tokenizer,n.options.keyValueSeparator),this.templates=[],this.elseTemplates=[];let c;const u=i.parseStream(s).on("start",()=>c=this.templates).on("tag:else",l=>{me(l.args),c=this.elseTemplates}).on("tag:endfor",l=>{me(l.args),u.stop()}).on("template",l=>c.push(l)).on("end",()=>{throw new Error(`tag ${e.getText()} not closed`)});u.start()}*render(e,s){const n=this.liquid.renderer;let i=ae(yield x(this.collection,e));if(!i.length){yield n.renderTemplates(this.elseTemplates,e,s);return}const r="continue-"+this.variable+"-"+this.collection.getText();e.push({continue:e.getRegister(r)});const o=yield this.hash.render(e);e.pop(),i=(this.liquid.options.orderedFilterParameters?Object.keys(o).filter(u=>Lt.includes(u)):Lt.filter(u=>o[u]!==void 0)).reduce((u,l)=>l==="offset"?ro(u,o.offset):l==="limit"?oo(u,o.limit):io(u),i),e.setRegister(r,(o.offset||0)+i.length);const c={forloop:new Pe(i.length,this.collection.getText(),this.variable)};e.push(c);for(const u of i){if(c[this.variable]=u,e.continueCalled=e.breakCalled=!1,yield n.renderTemplates(this.templates,e,s),e.breakCalled)break;c.forloop.next()}e.continueCalled=e.breakCalled=!1,e.pop()}*children(){const e=this.templates.slice();return this.elseTemplates&&e.push(...this.elseTemplates),e}*arguments(){yield this.collection;for(const e of Object.values(this.hash.hash))R(e)&&(yield e)}blockScope(){return[this.variable,"forloop"]}}function io(t){return[...t].reverse()}function ro(t,e){return t.slice(e)}function oo(t,e){return t.slice(0,e)}class ao extends k{constructor(e,s,n,i){for(super(e,s,n),this.templates=[],this.identifier=this.readVariable(),this.variable=this.identifier.content;s.length;){const r=s.shift();if(G(r)&&r.name==="endcapture")return;this.templates.push(i.parseToken(r,s))}throw new Error(`tag ${e.getText()} not closed`)}readVariable(){let e=this.tokenizer.readIdentifier();if(e.content||(e=this.tokenizer.readQuoted(),e))return e;throw this.tokenizer.error("invalid capture name")}*render(e){const n=yield this.liquid.renderer.renderTemplates(this.templates,e);e.bottom()[this.variable]=n}*children(){return this.templates}*localScope(){yield this.identifier}}class lo extends k{constructor(e,s,n,i){super(e,s,n),this.branches=[],this.elseTemplates=[],this.value=new E(this.tokenizer.readFilteredValue(),this.liquid),this.elseTemplates=[];let r=[],o=0;const a=i.parseStream(s).on("tag:when",c=>{if(o>0)return;r=[];const u=[];for(;!c.tokenizer.end();)u.push(c.tokenizer.readValueOrThrow()),c.tokenizer.skipBlank(),c.tokenizer.peek()===","?c.tokenizer.readTo(","):c.tokenizer.readTo("or");this.branches.push({values:u,templates:r})}).on("tag:else",()=>{o++,r=this.elseTemplates}).on("tag:endcase",()=>a.stop()).on("template",c=>{(r!==this.elseTemplates||o===1)&&r.push(c)}).on("end",()=>{throw new Error(`tag ${e.getText()} not closed`)});a.start()}*render(e,s){const n=this.liquid.renderer,i=g(yield this.value.value(e,e.opts.lenientIf));let r=!1;for(const o of this.branches)for(const a of o.values){const c=yield x(a,e,e.opts.lenientIf);if(j(i,c)){yield n.renderTemplates(o.templates,e,s),r=!0;break}}r||(yield n.renderTemplates(this.elseTemplates,e,s))}*arguments(){yield this.value,yield*this.branches.flatMap(e=>e.values)}*children(){const e=this.branches.flatMap(s=>s.templates);return this.elseTemplates&&e.push(...this.elseTemplates),e}}class co extends k{constructor(e,s,n){for(super(e,s,n);s.length;){const i=s.shift();if(G(i)&&i.name==="endcomment")return}throw new Error(`tag ${e.getText()} not closed`)}render(){}}class uo extends k{constructor(e,s,n,i){super(e,s,n);const r=this.tokenizer;for(this.file=Ue(r,this.liquid,i),this.currentFile=e.file;!r.end();){r.skipBlank();const o=r.p,a=r.readIdentifier();if((a.content==="with"||a.content==="for")&&(r.skipBlank(),r.peek()!==":")){const c=r.readValue();if(c){const u=r.p,l=r.readIdentifier();let h;l.content==="as"?h=r.readIdentifier():r.p=u,this[a.content]={value:c,alias:h&&h.content},r.skipBlank(),r.peek()===","&&r.advance();continue}}r.p=o;break}this.hash=new ne(r,n.options.keyValueSeparator)}*render(e,s){const{liquid:n,hash:i}=this,r=yield He(this.file,e,n);F(r,()=>`illegal file path "${r}"`);const o=e.spawn(),a=o.bottom();if(ge(a,yield i.render(e)),this.with){const{value:c,alias:u}=this.with;a[u||r]=yield x(c,e)}if(this.for){const{value:c,alias:u}=this.for,l=ae(yield x(c,e));a.forloop=new Pe(l.length,c.getText(),u);for(const h of l){a[u]=h;const p=yield n._parsePartialFile(r,o.sync,this.currentFile);yield n.renderer.renderTemplates(p,o,s),a.forloop.next()}}else{const c=yield n._parsePartialFile(r,o.sync,this.currentFile);yield n.renderer.renderTemplates(c,o,s)}}*children(e,s){return e&&m(this.file)?yield this.liquid._parsePartialFile(this.file,s,this.currentFile):[]}partialScope(){if(m(this.file)){const e=Object.keys(this.hash.hash);if(this.with){const{value:s,alias:n}=this.with;m(n)?e.push([n,s]):m(this.file)&&e.push([this.file,s])}if(this.for){const{value:s,alias:n}=this.for;m(n)?e.push([n,s]):m(this.file)&&e.push([this.file,s])}return{name:this.file,isolated:!0,scope:e}}}*arguments(){for(const e of Object.values(this.hash.hash))R(e)&&(yield e);if(this.with){const{value:e}=this.with;R(e)&&(yield e)}if(this.for){const{value:e}=this.for;R(e)&&(yield e)}}}function Ue(t,e,s){if(e.options.dynamicPartials){const r=t.readValue();if(t.assert(r,"illegal file path"),r.getText()==="none")return;if(ze(r)){const o=s.parse($n(r));return Ft(o)}return r}const n=[...t.readFileNameTemplate(e.options)],i=Ft(s.parseTokens(n));return i==="none"?void 0:i}function Ft(t){return t.length===1&&je(t[0].token)?t[0].token.getContent():t}function*He(t,e,s){return typeof t=="string"?t:Array.isArray(t)?s.renderer.renderTemplates(t,e):yield x(t,e)}class ho extends k{constructor(e,s,n,i){super(e,s,n);const{tokenizer:r}=e;this.file=Ue(r,this.liquid,i),this.currentFile=e.file;const o=r.p;r.readIdentifier().content==="with"?(r.skipBlank(),r.peek()!==":"?this.withVar=r.readValue():r.p=o):r.p=o,this.hash=new ne(r,n.options.jekyllInclude||n.options.keyValueSeparator)}*render(e,s){const{liquid:n,hash:i,withVar:r}=this,{renderer:o}=n,a=yield He(this.file,e,n);F(a,()=>`illegal file path "${a}"`);const c=e.saveRegister("blocks","blockMode");e.setRegister("blocks",{}),e.setRegister("blockMode",W.OUTPUT);const u=yield i.render(e);r&&(u[a]=yield x(r,e));const l=yield n._parsePartialFile(a,e.sync,this.currentFile);e.push(e.opts.jekyllInclude?{include:u}:u),yield o.renderTemplates(l,e,s),e.pop(),e.restoreRegister(c)}*children(e,s){return e&&m(this.file)?yield this.liquid._parsePartialFile(this.file,s,this.currentFile):[]}partialScope(){if(m(this.file)){let e;return this.liquid.options.jekyllInclude?e=["include"]:(e=Object.keys(this.hash.hash),this.withVar&&e.push([this.file,this.withVar])),{name:this.file,isolated:!1,scope:e}}}*arguments(){yield*Object.values(this.hash.hash).filter(R),R(this.file)&&(yield this.file),R(this.withVar)&&(yield this.withVar)}}class fo extends k{constructor(e,s,n){super(e,s,n),this.identifier=this.tokenizer.readIdentifier(),this.variable=this.identifier.content}render(e,s){const n=e.environments;be(n[this.variable])||(n[this.variable]=0),s.write(d(--n[this.variable]))}*localScope(){yield this.identifier}}class po extends k{constructor(e,s,n){super(e,s,n),this.candidates=[];const i=this.tokenizer.readValue();for(this.tokenizer.skipBlank(),i&&(this.tokenizer.peek()===":"?(this.group=i,this.tokenizer.advance()):this.candidates.push(i));!this.tokenizer.end();){const r=this.tokenizer.readValue();r&&this.candidates.push(r),this.tokenizer.readTo(",")}this.tokenizer.assert(this.candidates.length,()=>`empty candidates: "${e.getText()}"`)}*render(e,s){const i=`cycle:${yield x(this.group,e)}:`+this.candidates.join(","),r=e.getRegister("cycle");let o=r[i];o===void 0&&(o=r[i]=0);const a=this.candidates[o];return o=(o+1)%this.candidates.length,r[i]=o,yield x(a,e)}*arguments(){yield*this.candidates,this.group&&(yield this.group)}}class mo extends k{constructor(e,s,n,i){super(e,s,n),this.branches=[];let r=[];i.parseStream(s).on("start",()=>this.branches.push({value:new E(e.tokenizer.readFilteredValue(),this.liquid),templates:r=[]})).on("tag:elsif",o=>{F(!this.elseTemplates,"unexpected elsif after else"),this.branches.push({value:new E(o.tokenizer.readFilteredValue(),this.liquid),templates:r=[]})}).on("tag:else",o=>{me(o.args),F(!this.elseTemplates,"duplicated else"),r=this.elseTemplates=[]}).on("tag:endif",function(o){me(o.args),this.stop()}).on("template",o=>r.push(o)).on("end",()=>{throw new Error(`tag ${e.getText()} not closed`)}).start()}*render(e,s){const n=this.liquid.renderer;for(const{value:i,templates:r}of this.branches){const o=yield i.value(e,e.opts.lenientIf);if(H(o,e)){yield n.renderTemplates(r,e,s);return}}yield n.renderTemplates(this.elseTemplates||[],e,s)}*children(){const e=this.branches.flatMap(s=>s.templates);return this.elseTemplates&&e.push(...this.elseTemplates),e}arguments(){return this.branches.map(e=>e.value)}}class go extends k{constructor(e,s,n){super(e,s,n),this.identifier=this.tokenizer.readIdentifier(),this.variable=this.identifier.content}render(e,s){const n=e.environments;be(n[this.variable])||(n[this.variable]=0);const i=n[this.variable];n[this.variable]++,s.write(d(i))}*localScope(){yield this.identifier}}class yo extends k{constructor(e,s,n,i){super(e,s,n),this.file=Ue(this.tokenizer,this.liquid,i),this.currentFile=e.file,this.args=new ne(this.tokenizer,n.options.keyValueSeparator),this.templates=i.parseTokens(s)}*render(e,s){const{liquid:n,args:i,file:r}=this,{renderer:o}=n;if(r===void 0){e.setRegister("blockMode",W.OUTPUT),yield o.renderTemplates(this.templates,e,s);return}const a=yield He(this.file,e,n);F(a,()=>`illegal file path "${a}"`);const c=yield n._parseLayoutFile(a,e.sync,this.currentFile);e.setRegister("blockMode",W.STORE);const u=yield o.renderTemplates(this.templates,e),l=e.getRegister("blocks");l[""]===void 0&&(l[""]=(h,p)=>p.write(u)),e.setRegister("blockMode",W.OUTPUT),e.push(yield i.render(e)),yield o.renderTemplates(c,e,s),e.pop()}*children(e){const s=this.templates.slice();return e&&m(this.file)&&s.push(...yield this.liquid._parsePartialFile(this.file,!0,this.currentFile)),s}*arguments(){for(const e of Object.values(this.args.hash))R(e)&&(yield e);R(this.file)&&(yield this.file)}partialScope(){if(m(this.file))return{name:this.file,isolated:!1,scope:Object.keys(this.args.hash)}}}class wo extends k{constructor(e,s,n,i){super(e,s,n),this.templates=[];const r=/\w+/.exec(e.args);for(this.block=r?r[0]:"";s.length;){const o=s.shift();if(G(o)&&o.name==="endblock")return;const a=i.parseToken(o,s);this.templates.push(a)}throw new Error(`tag ${e.getText()} not closed`)}*render(e,s){const n=this.getBlockRender(e);e.getRegister("blockMode")===W.STORE?e.getRegister("blocks")[this.block]=n:yield n(new ot,s)}getBlockRender(e){const{liquid:s,templates:n}=this,i=e.getRegister("blocks")[this.block],r=function*(o,a){e.push({block:o}),yield s.renderer.renderTemplates(n,e,a),e.pop()};return i?(o,a)=>i(new ot(c=>r(o,c)),a):r}*children(){return this.templates}blockScope(){return["block"]}}class bo extends k{constructor(e,s,n){for(super(e,s,n),this.tokens=[];s.length;){const i=s.shift();if(G(i)&&i.name==="endraw")return;this.tokens.push(i)}throw new Error(`tag ${e.getText()} not closed`)}render(){return this.tokens.map(e=>e.getText()).join("")}}class ko extends Pe{constructor(e,s,n,i){super(e,n,i),this.length=e,this.cols=s}row(){return Math.floor(this.i/this.cols)+1}col0(){return this.i%this.cols}col(){return this.col0()+1}col_first(){return this.col0()===0}col_last(){return this.col()===this.cols}}class To extends k{constructor(e,s,n,i){super(e,s,n);const r=this.tokenizer.readIdentifier();this.tokenizer.skipBlank();const o=this.tokenizer.readIdentifier(),a=this.tokenizer.readValue();if(o.content!=="in"||!a)throw new Error(`illegal tag: ${e.getText()}`);this.variable=r.content,this.collection=a,this.args=new ne(this.tokenizer,n.options.keyValueSeparator),this.templates=[];let c;const u=i.parseStream(s).on("start",()=>c=this.templates).on("tag:endtablerow",()=>u.stop()).on("template",l=>c.push(l)).on("end",()=>{throw new Error(`tag ${e.getText()} not closed`)});u.start()}*render(e,s){let n=ae(yield x(this.collection,e));const i=yield this.args.render(e),r=i.offset||0,o=i.limit===void 0?n.length:i.limit;n=n.slice(r,r+o);const a=i.cols||n.length,c=this.liquid.renderer,u=new ko(n.length,a,this.collection.getText(),this.variable),l={tablerowloop:u};e.push(l);for(let h=0;h<n.length;h++,u.next())l[this.variable]=n[h],u.col0()===0&&(u.row()!==1&&s.write("</tr>"),s.write(`<tr class="row${u.row()}">`)),s.write(`<td class="col${u.col()}">`),yield c.renderTemplates(this.templates,e,s),s.write("</td>");n.length&&s.write("</tr>"),e.pop()}*children(){return this.templates}*arguments(){yield this.collection;for(const e of Object.values(this.args.hash))R(e)&&(yield e)}blockScope(){return[this.variable,"tablerowloop"]}}class xo extends k{constructor(e,s,n,i){super(e,s,n),this.branches=[],this.elseTemplates=[];let r=[],o=0;i.parseStream(s).on("start",()=>this.branches.push({value:new E(e.tokenizer.readFilteredValue(),this.liquid),test:Te,templates:r=[]})).on("tag:elsif",a=>{if(o>0){r=[];return}this.branches.push({value:new E(a.tokenizer.readFilteredValue(),this.liquid),test:H,templates:r=[]})}).on("tag:else",()=>{o++,r=this.elseTemplates}).on("tag:endunless",function(){this.stop()}).on("template",a=>{(r!==this.elseTemplates||o===1)&&r.push(a)}).on("end",()=>{throw new Error(`tag ${e.getText()} not closed`)}).start()}*render(e,s){const n=this.liquid.renderer;for(const{value:i,test:r,templates:o}of this.branches){const a=yield i.value(e,e.opts.lenientIf);if(r(a,e)){yield n.renderTemplates(o,e,s);return}}yield n.renderTemplates(this.elseTemplates,e,s)}*children(){const e=this.branches.flatMap(s=>s.templates);return this.elseTemplates&&e.push(...this.elseTemplates),e}arguments(){return this.branches.map(e=>e.value)}}class vo extends k{render(e,s){e.breakCalled=!0}}class _o extends k{render(e,s){e.continueCalled=!0}}class So extends k{constructor(e,s,n){super(e,s,n),this.tokenizer.skipBlank(),this.tokenizer.end()||(this.value=new E(this.tokenizer.readFilteredValue(),this.liquid))}*render(e,s){if(!this.value)return;const n=yield this.value.value(e,!1);s.write(n)}*arguments(){this.value&&(yield this.value)}}class Oo extends k{constructor(e,s,n,i){super(e,s,n);const r=this.tokenizer.readLiquidTagTokens(this.liquid.options);this.templates=i.parseTokens(r)}*render(e,s){yield this.liquid.renderer.renderTemplates(this.templates,e,s)}*children(){return this.templates}}class Lo extends k{constructor(e,s,n){if(super(e,s,n),e.args.search(/\n\s*[^#\s]/g)!==-1)throw new Error("every line of an inline comment must start with a '#' character")}render(){}}const Fo={assign:so,for:no,capture:ao,case:lo,comment:co,include:ho,render:uo,decrement:fo,increment:go,cycle:po,if:mo,layout:yo,block:wo,raw:bo,tablerow:To,unless:xo,break:vo,continue:_o,echo:So,liquid:Oo,"#":Lo};class ys{constructor(e={}){this.renderer=new qn,this.filters={},this.tags={},this.options=pi(e),this.parser=new B(this),st(Fo,(s,n)=>this.registerTag(n,s)),st(to,(s,n)=>this.registerFilter(n,s))}parse(e,s){return new B(this).parse(e,s)}_render(e,s,n){const i=s instanceof U?s:new U(s,this.options,n);return this.renderer.renderTemplates(e,i)}render(e,s,n){return _(this,void 0,void 0,function*(){return q(this._render(e,s,Object.assign(Object.assign({},n),{sync:!1})))})}renderSync(e,s,n){return D(this._render(e,s,Object.assign(Object.assign({},n),{sync:!0})))}renderToNodeStream(e,s,n={}){const i=new U(s,this.options,n);return this.renderer.renderTemplatesToNodeStream(e,i)}_parseAndRender(e,s,n){const i=this.parse(e);return this._render(i,s,n)}parseAndRender(e,s,n){return _(this,void 0,void 0,function*(){return q(this._parseAndRender(e,s,Object.assign(Object.assign({},n),{sync:!1})))})}parseAndRenderSync(e,s,n){return D(this._parseAndRender(e,s,Object.assign(Object.assign({},n),{sync:!0})))}_parsePartialFile(e,s,n){return new B(this).parseFile(e,s,Y.Partials,n)}_parseLayoutFile(e,s,n){return new B(this).parseFile(e,s,Y.Layouts,n)}_parseFile(e,s,n,i){return new B(this).parseFile(e,s,n,i)}parseFile(e,s){return _(this,void 0,void 0,function*(){return q(new B(this).parseFile(e,!1,s))})}parseFileSync(e,s){return D(new B(this).parseFile(e,!0,s))}*_renderFile(e,s,n){const i=yield this._parseFile(e,n.sync,n.lookupType);return yield this._render(i,s,n)}renderFile(e,s,n){return _(this,void 0,void 0,function*(){return q(this._renderFile(e,s,Object.assign(Object.assign({},n),{sync:!1})))})}renderFileSync(e,s,n){return D(this._renderFile(e,s,Object.assign(Object.assign({},n),{sync:!0})))}renderFileToNodeStream(e,s,n){return _(this,void 0,void 0,function*(){const i=yield this.parseFile(e);return this.renderToNodeStream(i,s,n)})}_evalValue(e,s){const n=new E(e,this),i=s instanceof U?s:new U(s,this.options);return n.value(i)}evalValue(e,s){return _(this,void 0,void 0,function*(){return q(this._evalValue(e,s))})}evalValueSync(e,s){return D(this._evalValue(e,s))}registerFilter(e,s){this.filters[e]=s}registerTag(e,s){this.tags[e]=S(s)?s:ki(s)}plugin(e){return e.call(this,ys)}express(){const e=this;let s=!0;return function(n,i,r){if(s){s=!1;const o=de(this.root);e.options.root.unshift(...o),e.options.layouts.unshift(...o),e.options.partials.unshift(...o)}e.renderFile(n,i).then(o=>r(null,o),r)}}analyze(e,s={}){return _(this,void 0,void 0,function*(){return $(e,s)})}analyzeSync(e,s={}){return I(e,s)}parseAndAnalyze(e,s,n={}){return _(this,void 0,void 0,function*(){return $(this.parse(e,s),n)})}parseAndAnalyzeSync(e,s,n={}){return I(this.parse(e,s),n)}variables(e,s={}){return _(this,void 0,void 0,function*(){const n=yield $(m(e)?this.parse(e):e,s);return Object.keys(n.variables)})}variablesSync(e,s={}){const n=I(m(e)?this.parse(e):e,s);return Object.keys(n.variables)}fullVariables(e,s={}){return _(this,void 0,void 0,function*(){const n=yield $(m(e)?this.parse(e):e,s);return Array.from(new Set(Object.values(n.variables).flatMap(i=>i.map(r=>String(r)))))})}fullVariablesSync(e,s={}){const n=I(m(e)?this.parse(e):e,s);return Array.from(new Set(Object.values(n.variables).flatMap(i=>i.map(r=>String(r)))))}variableSegments(e,s={}){return _(this,void 0,void 0,function*(){const n=yield $(m(e)?this.parse(e):e,s);return Array.from(ce(Object.values(n.variables).flatMap(i=>i.map(r=>r.toArray()))))})}variableSegmentsSync(e,s={}){const n=I(m(e)?this.parse(e):e,s);return Array.from(ce(Object.values(n.variables).flatMap(i=>i.map(r=>r.toArray()))))}globalVariables(e,s={}){return _(this,void 0,void 0,function*(){const n=yield $(m(e)?this.parse(e):e,s);return Object.keys(n.globals)})}globalVariablesSync(e,s={}){const n=I(m(e)?this.parse(e):e,s);return Object.keys(n.globals)}globalFullVariables(e,s={}){return _(this,void 0,void 0,function*(){const n=yield $(m(e)?this.parse(e):e,s);return Array.from(new Set(Object.values(n.globals).flatMap(i=>i.map(r=>String(r)))))})}globalFullVariablesSync(e,s={}){const n=I(m(e)?this.parse(e):e,s);return Array.from(new Set(Object.values(n.globals).flatMap(i=>i.map(r=>String(r)))))}globalVariableSegments(e,s={}){return _(this,void 0,void 0,function*(){const n=yield $(m(e)?this.parse(e):e,s);return Array.from(ce(Object.values(n.globals).flatMap(i=>i.map(r=>r.toArray()))))})}globalVariableSegmentsSync(e,s={}){const n=I(m(e)?this.parse(e):e,s);return Array.from(ce(Object.values(n.globals).flatMap(i=>i.map(r=>r.toArray()))))}}export{ys as L,Vo as _,Vs as a};
