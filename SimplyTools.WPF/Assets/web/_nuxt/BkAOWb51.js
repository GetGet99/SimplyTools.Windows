import{D as B}from"./BAlgIs_X.js";import{u as L,_ as T}from"./CC5p7vtn.js";import{_ as Y}from"./DmueuAKG.js";import{_ as D}from"./gQrGCUfV.js";import{_ as y}from"./D8PKUorR.js";import{T as A}from"./D7TXt3Px.js";import{u as E,A as N}from"./DGNIRpLh.js";import{e as F,r as p,q as $,g as w,w as o,o as m,a as r,c as x,n as q,b as i,t as v,F as z,y as O,J as C,h as U,d as g,K as j,L as J}from"./CfbvuZjT.js";import"./6lJdN27k.js";import"./DsERhPW5.js";import"./DX9jVxSH.js";import"./BAYpYBTo.js";import"./DlAUqK2U.js";import"./CQCgYrss.js";const K={class:"w-full md:w-[70vw] flex flex-col gap-6"},R={key:0,class:"w-full p-3 font-bold rounded-md text-sm"},G={class:"flex flex-col gap-2 w-full"},H={class:"flex flex-col gap-2"},Q={class:"p-2 bg-control-primary border-border-control-primary rounded-1 w-fit font-[system-ui] select-text text-wrap"},W={class:"flex gap-2 w-full lg:w-3/4"},me=F({__name:"chat",setup(X){E(N.pages.find(l=>l.path==="chat"));const u=p(""),t=p([]),n=p(!1),d=p(!1),a=p(""),b=p("You are a helpful assistant that provides clear and concise answers. Be polite, informative, and concise. Ask clarifying questions if necessary."),{accepted:P}=L();let _=null;function I(){const l=navigator.userAgent.toLowerCase();return l.includes("edg/")?"edge":l.includes("chrome/")?"chrome":"other"}$(async()=>{if(!("LanguageModel"in self)){d.value=!1,a.value="Your browser does not support the Prompt API. Please use Chrome 138+ or Edge 138+.";return}d.value=!0,a.value=await LanguageModel.availability(),a.value==="unavailable"&&(I()==="edge"?a.value="Prompt API is available in Microsoft Edge 138+, but it must be manually enabled in edge://flags.":a.value="Prompt API is currently unavailable in this browser.")});async function k(){if(!P.value){t.value.push({role:"assistant",content:"You must accept the AI Policy to use this tool."});return}if(!d.value||a.value==="unavailable"){t.value.push({role:"assistant",content:"Prompt API not available in your environment."});return}if(!u.value.trim())return;t.value.push({role:"user",content:u.value}),n.value=!0,t.value.push(j({role:"assistant",content:""}));const l=t.value[t.value.length-1];n.value=!0;const e=u.value;u.value="";try{_||(l.content="Initializing chat... please be patient",_=await LanguageModel.create({initialPrompts:[{role:"system",content:b.value}],monitor(f){f.addEventListener("downloadprogress",h=>{l.content=`Your browser is downloading model: ${h.loaded*100}% completed`})}}),l.content="");const c=_.promptStreaming(e);for await(const f of c)l.content+=f,J(t)}catch(c){t.value.push({role:"assistant",content:`Error: ${c.message||c}`})}finally{n.value=!1}}function S(){t.value=[],_=null}return(l,e)=>{const c=B,f=T,h=Y,V=D;return m(),w(V,{category:"AI",tool:"Chat",class:"flex justify-center"},{summary:o(()=>e[5]||(e[5]=[g(" AI-powered streaming chat using the Prompt API. System prompts and conversation context are supported. ",-1)])),details:o(()=>e[6]||(e[6]=[r("p",null," Messages appear in real-time as the AI responds. You can provide a system prompt to guide behavior and clear the chat at any time. ",-1)])),default:o(()=>[r("div",K,[a.value!=="available"&&a.value!=="downloadable"?(m(),x("div",R,v(a.value),1)):q("",!0),r("details",G,[e[2]||(e[2]=r("summary",null,"System Prompt",-1)),i(A,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=s=>b.value=s),placeholder:"Optional system prompt",readonly:t.value.length>0,style:{height:"unset"},class:"w-full",multiline:""},null,8,["modelValue","readonly"])]),r("div",H,[(m(!0),x(z,null,O(t.value,(s,M)=>(m(),x("div",{key:M,class:C([s.role==="user"?"items-end":"items-start","flex flex-col gap-1"])},[r("span",{class:C(s.role==="user"?"font-bold":"italic")},v(s.role==="user"?"You":s.role==="assistant"?"Assistant":"System")+": ",3),r("pre",Q,v(s.content),1)],2))),128))]),i(A,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=s=>u.value=s),placeholder:"Type a message...",class:"w-full min-h-[50px]",multiline:""},null,8,["modelValue"]),r("div",W,[i(h,null,{fallback:o(()=>[i(y,{disabled:n.value||!d.value||a.value==="unavailable"},{default:o(()=>[g(v(n.value?"Sending...":"Send"),1)]),_:1},8,["disabled"])]),default:o(()=>[U(P)?(m(),w(y,{key:0,disabled:n.value||!d.value||a.value==="unavailable",onClick:k},{default:o(()=>[g(v(n.value?"Sending...":"Send"),1)]),_:1},8,["disabled"])):(m(),w(f,{key:1},{trigger:o(()=>[i(c,{"as-child":""},{default:o(()=>[i(y,{class:"px-4 py-2",disabled:n.value||!d.value||a.value==="unavailable"},{default:o(()=>e[3]||(e[3]=[g(" Send ",-1)])),_:1,__:[3]},8,["disabled"])]),_:1})]),_:1}))]),_:1}),i(y,{onClick:S},{default:o(()=>e[4]||(e[4]=[g("Clear Chat",-1)])),_:1,__:[4]})])])]),_:1})}}});export{me as default};
